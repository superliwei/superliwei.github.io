function trace(a){console.log(a)}var GlobalEditor={};
GlobalEditor.init=function(){this.mainLayout=new GlobalEditor.MainLayout("#mainLayout");this.topMenu=new GlobalEditor.TopMenu("#topMenu");this.propertiesPanel=new GlobalEditor.PropertiesPanel;this.historyPanel=new GlobalEditor.HistoryPanel;this.dataSourcePanel=new GlobalEditor.DataSourcePanel;this.editorContainer=new GlobalEditor.EditorContainer($("#editorContainer"));this.leftPanel=new GlobalEditor.LeftPanel("#leftPanel");this.settingWin=new GlobalEditor.SettingWin("#settingWin");this.inputWin=new GlobalEditor.InputWin("#inputWin");
this.onlineFileWin=new GlobalEditor.OnlineFileWin("#onlineFileWin");this.editDataSourceWin=new GlobalEditor.EditDataSourceWin("#editDataSourceWin");this.terrianPanel=new GlobalEditor.TerrainPanel("#terrainPanel");this.imageLayerPanel=new GlobalEditor.ImageLayerPanel("#imageLayerPanel");this.editImageLayerWin=new GlobalEditor.EditImageLayerWin("#editImageLayerWin");this.cameraPanel=new GlobalEditor.CameraPanel("#cameraPanel");this.editMaterialWin=new GlobalEditor.EditMaterialWin("#editMaterialWin");
this.ToolManager.init()};$(function(){GlobalEditor.init();GlobalEditor.Test.start()});
GlobalEditor.Test=function(){return{start:function(){},testPolylineOutlineMaterialProperty:function(){var a=GlobalEditor.editorContainer.viewer.entities.add({box:{dimensions:new Cesium.Cartesian3(4E5,4E5,4E5),material:Cesium.Color.RED.withAlpha(0.5),outline:!0,outlineColor:Cesium.Color.BLACK},position:Cesium.Cartesian3.fromDegrees(25,44)}),b=new Cesium.PolylineOutlineMaterialProperty;a.box.material=b},outImageLibConfig:function(){$(document).click(function(){var a=$("<input type='file' multiple='multiple'>");
a.change(function(){var b=a.get(0).files,c=[];$.each(b,function(){c.push(this.name)});trace(JSON.stringify(c))});a.trigger("click")})},testCodeMasterEncode:function(){trace(GlobalEditor.CodeMaster.encode("hello world!"))},testCodeMasterDecode:function(){var a=GlobalEditor.CodeMaster.decode("=02bj5CbpFWbnB0auFGbi9mclhWYHZ1cidEOnRmM5knYHFFa");trace(a)},testAddCzmlDataSourceWithString:function(){var a=[];a.push({id:"document",version:"1.0"});for(var b=0;b<100;b++)a.push({point:{color:{rgba:[255,255,
255,255]},pixelSize:10,outlineColor:{rgba:[0,0,255,50]},outlineWidth:1},position:{cartographicDegrees:[-75.166493*Math.random(),39.9060534*Math.random(),0]}});GlobalEditor.GeneralManager.addDataSource({name:"testCZMLString","class":"CZML",type:"string",string:JSON.stringify(a)})},testAddCzmlDataSourceWithUrl:function(){GlobalEditor.GeneralManager.addDataSource({name:"testCZMLUrl","class":"CZML",type:"url",url:"assets/libs/Cesium-1.22/Apps/SampleData/simple.czml"})},testAddCzmlDataSourceWithJs:function(){GlobalEditor.GeneralManager.addDataSource({name:"testCZMLJs",
"class":"CZML",type:"js",js:'(function(){\n\tvar czml = [];\n\tczml.push({\n\t\tid:"document",\n\t\tversion:"1.0"\n\t});\n\tfor (var i=0;i<100;i++)\n\t{\n\t\tvar tx = 100*Math.random();\n\t\tvar ty = -50*Math.random();\n\t\tvar p = {\n\t\t\tpoint:{\n\t\t\t\tcolor:{rgba:[255, 255, 0, 255]},\n\t            pixelSize:5,\n\t            outlineColor:{rgba:[0, 0, 255, 50]},\n\t\t\t\toutlineWidth:1\n\t\t\t},\n\t\t\tposition:{cartographicDegrees:[tx,ty,0]}\n\t\t};\n\t\tczml.push(p);\n\t}\n\tvar ds = new Cesium.CzmlDataSource();\n\tds.load(czml);\n\treturn ds;\n})();'})},
testAddGeoJsonDataSourceWithUrl:function(){GlobalEditor.GeneralManager.addDataSource({name:"testGeoJsonUrl","class":"GeoJSON",type:"url",url:"assets/libs/Cesium-1.22/Apps/SampleData/simplestyles.geojson"})},testAddTopoJsonDataSourceWithUrl:function(){GlobalEditor.GeneralManager.addDataSource({name:"testTopoJsonUrl","class":"TopoJSON",type:"url",url:"assets/libs/Cesium-1.22/Apps/SampleData/ne_10m_us_states.topojson"})},testAddKmlDataSourceWithUrl:function(){GlobalEditor.GeneralManager.addDataSource({name:"testKMLUrl",
"class":"KML",type:"url",url:"assets/libs/Cesium-1.22/Apps/SampleData/kml/gdpPerCapita2008.kmz"})},testAddCustomDataSourceWithUrl:function(){GlobalEditor.GeneralManager.addDataSource({name:"testCustomUrl","class":"Custom",type:"url",url:"assets/data/custom.txt"})},testAddImageLayerWithJs:function(){GlobalEditor.GeneralManager.addImageLayer({name:"testAddImageLayer",js:"Cesium.createTileMapServiceImageryProvider({\n    url : 'https://cesiumjs.org/blackmarble',\n    credit : 'Black Marble imagery courtesy NASA Earth Observatory',\n    flipXY : true\n})"});
GlobalEditor.GeneralManager.addImageLayer({name:"Single Image",js:"new Cesium.SingleTileImageryProvider({\n    url : 'assets/libs/Cesium-1.22/Apps/Sandcastle/images/Cesium_Logo_overlay.png',\n    rectangle : Cesium.Rectangle.fromDegrees(-75.0, 28.0, -67.0, 29.75)\n})"});GlobalEditor.GeneralManager.addImageLayer({name:"Tile Coordinates",js:"new Cesium.TileCoordinatesImageryProvider()"});GlobalEditor.GeneralManager.addImageLayer({name:"Grid",js:"new Cesium.GridImageryProvider()"});GlobalEditor.GeneralManager.addImageLayer({name:"TileMapService Image",
js:" Cesium.createTileMapServiceImageryProvider({\n           url : 'assets/libs/Cesium-1.22/Apps/Sandcastle/images/cesium_maptiler/Cesium_Logo_Color'\n })"})}}}();GlobalEditor.Settings={version:"v1.0",signature:"==QP9ElY25UbMNHbXlFdkdUUyVzVZNnSyIWeWdUYR1GeoJWbzNXYHZVeiJjSzl1V1IXUHRGdZdFbzxUbOZnYR1TP"};GlobalEditor.KeyboardManager={};
GlobalEditor.KeyboardManager.init=function(){function a(a){return a.target instanceof HTMLTextAreaElement||a.target instanceof HTMLInputElement}$(window).keydown(function(b){if(!a(b))switch(b.keyCode){case 79:b.ctrlKey&&b.preventDefault();break;case 83:b.ctrlKey&&b.preventDefault();break;case 85:b.ctrlKey&&b.preventDefault();break;case 49:b.ctrlKey&&b.preventDefault();break;case 50:b.ctrlKey&&b.preventDefault();break;case 51:b.ctrlKey&&b.preventDefault();break;case 52:b.ctrlKey&&b.preventDefault();
break;case 53:b.ctrlKey&&b.preventDefault();break;case 54:b.ctrlKey&&b.preventDefault();break;case 89:b.ctrlKey&&b.preventDefault();break;case 90:b.ctrlKey&&b.preventDefault();break;case 68:b.ctrlKey&&b.preventDefault();break;case 70:b.ctrlKey&&b.preventDefault();break;case 72:b.ctrlKey&&b.preventDefault()}});$(window).keyup(function(b){if(!a(b))switch(b.keyCode){case 79:b.ctrlKey&&GlobalEditor.KeyboardManager.execute("Ctrl+O");break;case 83:b.ctrlKey&&GlobalEditor.KeyboardManager.execute("Ctrl+S");
break;case 90:b.ctrlKey&&GlobalEditor.KeyboardManager.execute("Ctrl+Z");break;case 89:b.ctrlKey&&GlobalEditor.KeyboardManager.execute("Ctrl+Y");break;case 46:GlobalEditor.KeyboardManager.execute("Delete");break;case 67:b.ctrlKey&&GlobalEditor.KeyboardManager.execute("Ctrl+C");break;case 86:b.ctrlKey&&GlobalEditor.KeyboardManager.execute("Ctrl+V");break;case 88:b.ctrlKey&&GlobalEditor.KeyboardManager.execute("Ctrl+X");break;case 68:b.ctrlKey&&b.shiftKey&&GlobalEditor.KeyboardManager.execute("Ctrl+Shift+D");
break;case 76:b.ctrlKey&&b.shiftKey&&GlobalEditor.KeyboardManager.execute("Ctrl+Shift+L");break;case 70:b.ctrlKey&&GlobalEditor.KeyboardManager.execute("Ctrl+F");break;case 72:b.ctrlKey&&GlobalEditor.KeyboardManager.execute("Ctrl+H");break;case 49:b.ctrlKey&&b.shiftKey?GlobalEditor.KeyboardManager.execute("Ctrl+Shift+1"):b.ctrlKey&&GlobalEditor.KeyboardManager.execute("Ctrl+1");break;case 50:b.ctrlKey&&b.shiftKey?GlobalEditor.KeyboardManager.execute("Ctrl+Shift+2"):b.ctrlKey&&GlobalEditor.KeyboardManager.execute("Ctrl+2");
break;case 51:b.ctrlKey&&GlobalEditor.KeyboardManager.execute("Ctrl+3");break;case 52:b.ctrlKey&&GlobalEditor.KeyboardManager.execute("Ctrl+4");break;case 53:b.ctrlKey&&GlobalEditor.KeyboardManager.execute("Ctrl+5");break;case 54:b.ctrlKey&&GlobalEditor.KeyboardManager.execute("Ctrl+6");break;case 85:b.ctrlKey&&GlobalEditor.KeyboardManager.execute("Ctrl+U")}})};
GlobalEditor.KeyboardManager.execute=function(a){switch(a){case "Ctrl+O":GlobalEditor.File.openFile();break;case "onlineFile":GlobalEditor.onlineFileWin.show();break;case "Ctrl+S":GlobalEditor.File.saveFile();break;case "export":GlobalEditor.File.exportImage();break;case "Ctrl+Z":GlobalEditor.HistoryManager.undo();break;case "Ctrl+Y":GlobalEditor.HistoryManager.redo();break;case "Delete":GlobalEditor.GeneralManager.removeSelectedComponent();break;case "Ctrl+C":GlobalEditor.Clipboard.copy();break;
case "Ctrl+V":GlobalEditor.Clipboard.paste();break;case "Ctrl+X":GlobalEditor.Clipboard.cut();break;case "Ctrl+Shift+D":GlobalEditor.dataSourcePanel.newItem();break;case "editDataSource":GlobalEditor.dataSourcePanel.editSelectedItem();break;case "delDataSource":GlobalEditor.dataSourcePanel.delSelectedItem();break;case "Ctrl+Shift+L":GlobalEditor.imageLayerPanel.newItem();break;case "editImageLayer":GlobalEditor.imageLayerPanel.editSelectedItem();break;case "delImageLayer":GlobalEditor.imageLayerPanel.delSelectedItem();
break;case "Ctrl+H":GlobalEditor.editorContainer.flyHome();break;case "Ctrl+F":GlobalEditor.editorContainer.flyToSelectedItem();break;case "Ctrl+U":GlobalEditor.settingWin.show(0);break;case "showQuickKey":GlobalEditor.settingWin.show(1);break;case "Ctrl+1":GlobalEditor.topMenu.panelMenuController.selectValue("properties");break;case "Ctrl+2":GlobalEditor.topMenu.panelMenuController.selectValue("history");break;case "Ctrl+3":GlobalEditor.topMenu.panelMenuController.selectValue("dataSource");break;
case "Ctrl+4":GlobalEditor.topMenu.panelMenuController.selectValue("terrain");break;case "Ctrl+5":GlobalEditor.topMenu.panelMenuController.selectValue("imageLayer");break;case "Ctrl+6":GlobalEditor.topMenu.panelMenuController.selectValue("camera");break;case "Ctrl+Shift+1":GlobalEditor.mainLayout.toggleLeft();break;case "Ctrl+Shift+2":GlobalEditor.mainLayout.toggleRight();break;case "about":GlobalEditor.settingWin.show(2)}};$(function(){GlobalEditor.KeyboardManager.init()});
GlobalEditor.HistoryManager={};GlobalEditor.HistoryManager.UPDATE="historyManagerUpdate";GlobalEditor.HistoryManager.maxLen=50;GlobalEditor.HistoryManager.items=[];GlobalEditor.HistoryManager.idx=-1;GlobalEditor.HistoryManager.add=function(a,b,c){for(;this.items.length-1>this.idx;)this.items.pop();a=new GlobalEditor.HistoryItem(a,b,c);this.items.push(a);this.items.length>this.maxLen&&this.items.shift();a.redo();this.idx=this.items.length-1;$(document).trigger(GlobalEditor.HistoryManager.UPDATE)};
GlobalEditor.HistoryManager.undo=function(){this.idx>-1&&(this.items[this.idx].undo(),this.idx--,$(document).trigger(GlobalEditor.HistoryManager.UPDATE))};GlobalEditor.HistoryManager.redo=function(){this.idx<this.items.length-1&&(this.idx++,this.items[this.idx].redo(),$(document).trigger(GlobalEditor.HistoryManager.UPDATE))};GlobalEditor.HistoryManager.removeAll=function(){for(;this.items.length>0;)this.items.pop();this.idx=-1;$(document).trigger(GlobalEditor.HistoryManager.UPDATE)};
GlobalEditor.HistoryManager.go=function(a){for(a=this.items.indexOf(a);this.idx!=a;)a<this.idx?(this.items[this.idx].undo(),this.idx--):(this.idx++,this.items[this.idx].redo());$(document).trigger(GlobalEditor.HistoryManager.UPDATE)};GlobalEditor.HistoryItem=function(a,b,c){this.type=a;this.undo=b;this.redo=c};GlobalEditor.HistoryManager.addEditAction=function(a,b,c,e){this.add(a,function(){e(b)},function(){e(c)})};
GlobalEditor.GeneralManager=function(){var a={switchToolIdx:function(a){var c=GlobalEditor.ToolManager.getSelectedIdx();GlobalEditor.HistoryManager.addEditAction("switchTool",c,a,function(a){GlobalEditor.toolPanel.selectIdx(a);GlobalEditor.ToolManager.selectToolIdx(a)})},addDataSource:function(a){var c,e;GlobalEditor.HistoryManager.add("addDataSource",function(){GlobalEditor.dataSourcePanel.removeItem(c);GlobalEditor.DataSourceManager.remove(e)},function(){c==void 0&&(e=new GlobalEditor.DataSource(a),
c=new GlobalEditor.DataSourceEditItem(a,e));GlobalEditor.dataSourcePanel.addItem(c);GlobalEditor.DataSourceManager.add(e)})},updateDataSource:function(a,c){var e=GlobalEditor.ObjectUtil.clone(a.info);GlobalEditor.HistoryManager.addEditAction("editDataSource",e,c,function(c){a.updateInfo(c)})},setDataSourceActive:function(a,c){GlobalEditor.HistoryManager.addEditAction("editDataSource",a.isActive,c,function(c){a.setActive(c)})}};a.selectDataSource=function(b){var c=GlobalEditor.dataSourcePanel.getSelectedItem();
c===b?a.selectDataSource(null):GlobalEditor.HistoryManager.addEditAction("editDataSource",c,b,function(a){GlobalEditor.dataSourcePanel.selectItem(a)})};a.removeDataSource=function(a){var c=-1,e=!1;GlobalEditor.HistoryManager.add("delDataSource",function(){GlobalEditor.dataSourcePanel.addItemAt(a,c);GlobalEditor.DataSourceManager.add(a.dataSource);e&&GlobalEditor.dataSourcePanel.selectItem(a)},function(){c=GlobalEditor.dataSourcePanel.getItems().indexOf(a);(e=a.selected)&&GlobalEditor.dataSourcePanel.selectItem(null);
GlobalEditor.dataSourcePanel.removeItem(a);GlobalEditor.DataSourceManager.remove(a.dataSource)})};a.addImageLayer=function(a){var c,e;GlobalEditor.HistoryManager.add("addImageLayer",function(){GlobalEditor.dataSourcePanel.removeItem(c);GlobalEditor.ImageLayerManager.remove(e)},function(){c==void 0&&(e=new GlobalEditor.ImageLayer(a),c=new GlobalEditor.EditImageLayerItem(a,e));GlobalEditor.imageLayerPanel.addItem(c);GlobalEditor.ImageLayerManager.add(e)})};a.removeImageLayer=function(a){var c=-1,e=
!1;GlobalEditor.HistoryManager.add("delImageLayer",function(){GlobalEditor.imageLayerPanel.addItemAt(a,c);GlobalEditor.ImageLayerManager.add(a.imageLayer,c);e&&(GlobalEditor.imageLayerPanel.selectItem(a),GlobalEditor.imageLayerPanel.setTarget(a))},function(){c=GlobalEditor.imageLayerPanel.getItems().indexOf(a);if(e=a.selected)GlobalEditor.imageLayerPanel.selectItem(null),GlobalEditor.imageLayerPanel.setTarget(null);GlobalEditor.imageLayerPanel.removeItem(a);GlobalEditor.ImageLayerManager.remove(a.imageLayer)})};
a.selectImageLayer=function(b){var c=GlobalEditor.imageLayerPanel.getSelectedItem();c===b?a.selectImageLayer(null):GlobalEditor.HistoryManager.addEditAction("editImageLayer",c,b,function(a){GlobalEditor.imageLayerPanel.selectItem(a);GlobalEditor.imageLayerPanel.setTarget(a)})};a.updateImageLayer=function(a,c){var e=GlobalEditor.ObjectUtil.clone(a.info);GlobalEditor.HistoryManager.addEditAction("editImageLayer",e,c,function(c){a.updateInfo(c);GlobalEditor.imageLayerPanel.setTarget(a)})};a.moveImageLayerUp=
function(a){GlobalEditor.imageLayerPanel.getItems().indexOf(a)!=0&&GlobalEditor.HistoryManager.add("editImageLayer",function(){GlobalEditor.imageLayerPanel.moveItemDown(a);GlobalEditor.ImageLayerManager.moveLayerDown(a.imageLayer)},function(){GlobalEditor.imageLayerPanel.moveItemUp(a);GlobalEditor.ImageLayerManager.moveLayerUp(a.imageLayer)})};a.moveImageLayerDown=function(a){var c=GlobalEditor.imageLayerPanel.getItems();c.indexOf(a)!=c.length-1&&GlobalEditor.HistoryManager.add("editImageLayer",function(){GlobalEditor.imageLayerPanel.moveItemUp(a);
GlobalEditor.ImageLayerManager.moveLayerUp(a.imageLayer)},function(){GlobalEditor.imageLayerPanel.moveItemDown(a);GlobalEditor.ImageLayerManager.moveLayerDown(a.imageLayer)})};a.addComponent=function(a){var c;GlobalEditor.HistoryManager.add("addComponent",function(){GlobalEditor.leftPanel.getComponentContainer().removeItem(c)},function(){if(c==void 0){var e=a.componentName,d=new GlobalEditor.ComponentManager.map[e](a.componentOptions);c=new GlobalEditor.EditComponentItem({icon:a.icon,name:e},d)}GlobalEditor.leftPanel.getComponentContainer().addItem(c)})};
a.selectComponent=function(b){var c=GlobalEditor.leftPanel.getComponentContainer().getSelectedItem();c==null&&c==b||(c===b?a.selectComponent(null):GlobalEditor.HistoryManager.addEditAction("editComponent",c,b,function(a){GlobalEditor.leftPanel.getComponentContainer().selectItem(a);GlobalEditor.propertiesPanel.update()}))};a.removeComponent=function(a){var c=-1;GlobalEditor.HistoryManager.add("delComponent",function(){GlobalEditor.leftPanel.getComponentContainer().addItemAt(a,c);GlobalEditor.leftPanel.getComponentContainer().selectItem(a);
GlobalEditor.propertiesPanel.update()},function(){c=GlobalEditor.leftPanel.getComponentContainer().getItems().indexOf(a);GlobalEditor.leftPanel.getComponentContainer().selectItem(null);GlobalEditor.leftPanel.getComponentContainer().removeItem(a);GlobalEditor.propertiesPanel.update()})};a.removeSelectedComponent=function(){var a=GlobalEditor.leftPanel.getComponentContainer().getSelectedItem();a!=null&&this.removeComponent(a)};return a}();GlobalEditor.Clipboard={};GlobalEditor.Clipboard.targets=[];
GlobalEditor.Clipboard.isCut=!1;GlobalEditor.Clipboard.copy=function(){var a=GlobalEditor.leftPanel.getComponentContainer().getSelectedItem();if(a!=null&&!(this.targets.indexOf(a)>-1)){var b=this.targets.concat(),c=this.isCut;GlobalEditor.HistoryManager.add("copy",function(){GlobalEditor.Clipboard.targets=b;GlobalEditor.Clipboard.isCut=c},function(){GlobalEditor.Clipboard.targets=[a];GlobalEditor.Clipboard.isCut=!1})}};
GlobalEditor.Clipboard.cut=function(){var a=GlobalEditor.leftPanel.getComponentContainer(),b=a.getSelectedItem();if(b!=null){var c=this.targets.concat(),e=[b],d=this.isCut,f=-1;GlobalEditor.HistoryManager.add("cut",function(){a.addItemAt(GlobalEditor.Clipboard.targets[0],f);GlobalEditor.Clipboard.targets=c;a.selectItem(e[0]);GlobalEditor.Clipboard.isCut=d},function(){GlobalEditor.Clipboard.targets=[b];f=a.getItems().indexOf(b);a.removeItem(b);a.selectItem(null);GlobalEditor.Clipboard.isCut=!0})}};
GlobalEditor.Clipboard.paste=function(){var a=GlobalEditor.leftPanel.getComponentContainer(),b=a.getSelectedItem();if(this.targets.length>0&&this.isCut){var c=GlobalEditor.Clipboard.targets.concat(),e=[b];GlobalEditor.HistoryManager.add("paste",function(){a.removeItem(c[0]);a.selectItem(e[0]);GlobalEditor.Clipboard.targets=c;GlobalEditor.Clipboard.isCut=!0},function(){a.addItem(GlobalEditor.Clipboard.targets[0]);a.selectItem(GlobalEditor.Clipboard.targets[0]);GlobalEditor.Clipboard.targets=[];GlobalEditor.Clipboard.isCut=
!1})}else if(this.targets.length>0&&!this.isCut){var d=this.pasteUtil.getCurrentGps();if(d!=void 0){var f,e=[b];GlobalEditor.HistoryManager.add("paste",function(){a.removeItem(f);a.selectItem(e[0])},function(){f==void 0&&(f=GlobalEditor.Clipboard.targets[0].clone(function(a){a.gps=d;return a}));a.addItem(f);a.selectItem(f)})}}};
GlobalEditor.Clipboard.CesiumPasteUtil=function(){var a;$(document).mousemove(function(b){a={x:b.clientX,y:b.clientY}});this.getCurrentGps=function(){if(a!=void 0){var b,c=GlobalEditor.editorContainer.container.offset().left,e=GlobalEditor.editorContainer.container.offset().top,c=new Cesium.Cartesian2(a.x-c,a.y-e),e=GlobalEditor.editorContainer.viewer;if(c=e.camera.pickEllipsoid(c,e.scene.globe.ellipsoid))b=Cesium.Cartographic.fromCartesian(c),c=Cesium.Math.toDegrees(b.longitude),b={lat:Cesium.Math.toDegrees(b.latitude),
lng:c};return b}}};GlobalEditor.Clipboard.pasteUtil=new GlobalEditor.Clipboard.CesiumPasteUtil;
GlobalEditor.File={openFile:function(){var a=this;this.browser(function(b){b.name.split(".").indexOf("ge")!==1?GlobalEditor.Alert.show("\u6587\u4ef6\u683c\u5f0f\u4e0d\u5bf9!"):a.readText(b,function(b){a.openSavedData(b)})})},saveFile:function(){var a=this;GlobalEditor.inputWin.show({icon:"save icon",title:"\u4fdd\u5b58\u6587\u4ef6",placeholder:"\u8f93\u5165\u6587\u4ef6\u540d\u79f0",rightlabel:".ge",value:"GlobalEditor-"+(new Date).getTime(),submitLabel:"\u4fdd\u5b58",onSubmit:function(b){var c=a.getSaveData(),
c=JSON.stringify(c);a.saveText(c,b+".ge")}})},saveData:function(a,b){var c=$("<a>");c.attr("href",a);c.attr("download",b);c.get(0).click()},saveText:function(a,b){this.saveData("data:application/octet-stream;base64,"+Base64.encode(a),b)},browser:function(a){var b=$("<input type='file'>");b.trigger("click");b.change(function(){var c=b.get(0).files[0];a(c)})},readText:function(a,b){$("#loadingMask").dimmer({closable:!1});$("#loadingMask").find(".ui.text.loader").text("\u6587\u4ef6\u8bfb\u53d6\u4e2d...");
$("#loadingMask").dimmer("show");var c=new FileReader;c.onload=function(){$("#loadingMask").dimmer("hide");b(c.result)};c.readAsText(a)},exportImage:function(){var a=this;GlobalEditor.inputWin.show({icon:"file image outline icon",title:"\u5bfc\u51fa\u56fe\u7247",placeholder:"\u8f93\u5165\u56fe\u7247\u540d\u79f0",rightlabel:".png",value:"export-"+(new Date).getTime(),submitLabel:"\u5bfc\u51fa",onSubmit:function(b){var c=GlobalEditor.editorContainer.viewer.canvas;c.getContext("2d");c=c.toDataURL("png");
c=c.replace("image/png","image/octet-stream");a.saveData(c,b+".png")}})},getSaveMap:function(){return[{name:"editor",delegate:GlobalEditor.editorContainer},{name:"dataSource",delegate:GlobalEditor.dataSourcePanel},{name:"terrian",delegate:GlobalEditor.terrianPanel},{name:"imageLayer",delegate:GlobalEditor.imageLayerPanel},{name:"components",delegate:GlobalEditor.leftPanel.getComponentContainer()}]},getSaveData:function(){var a={name:"GlobalEditor|"+GlobalEditor.Settings.signature,date:new Date,version:GlobalEditor.Settings.version},
b=this.getSaveMap();$.each(b,function(){a[this.name]=this.delegate.getSettings()});return a},resetEditor:function(){var a=this.getSaveMap();$.each(a,function(){this.delegate.clear()});GlobalEditor.HistoryManager.removeAll();GlobalEditor.editorContainer.viewer.camera.flyHome(0)},openSavedData:function(a){this.resetEditor();var b=JSON.parse(a),a=this.getSaveMap();$.each(a,function(){this.delegate.setSettings(b[this.name])})}};
GlobalEditor.MainLayout=function(a){function b(){c.outerWidth(i);d.outerWidth(k);var a=$(window).width()-i-k-f.outerWidth()-g.outerWidth();e.outerWidth(a);var b=$(window).height()-$("#topMenu").outerHeight();c.outerHeight(b);d.outerHeight(b);e.outerHeight(b);e.css("left",i+f.outerWidth());d.css("left",i+a+f.outerWidth()+g.outerWidth());f.outerHeight(b);g.outerHeight(b);f.css("left",i);g.css("left",i+a+f.outerWidth());$(document).trigger(GlobalEditor.MainLayout.Event.RESIZE);a=b-n-10;l.outerHeight(a-
q.outerHeight());o.outerHeight(a);r.outerHeight(a);u.outerHeight(a);s.outerHeight(a);m.outerHeight(a)}this.view=$(a);var c=this.view.find("#leftBox"),e=this.view.find("#centerBox"),d=this.view.find("#rightBox"),a=this.view.find(".vDivide"),f=a.eq(0),g=a.eq(1),h=f.find(".handle"),j=g.find(".handle"),i=322,k=320;h.click(function(){i=i==322?0:322;b()});j.click(function(){k=k==320?0:320;b()});c.css("position","absolute");c.css("overflow","auto");e.css("position","absolute");d.css("position","absolute");
this.view.find(".menu.tabular .item").tab();var l=this.view.find("#propertiesPanel .segment");l.css("overflow","auto");var q=this.view.find("#propertiesPanel #header"),o=this.view.find("#historyPanel .segment");o.css("padding",5);o.css("overflow","auto");var r=this.view.find("#dataSourcePanel .segment");r.css("padding",5);r.css("overflow","auto");var u=this.view.find("#terrainPanel .segment");u.css("overflow","auto");var s=this.view.find("#imageLayerPanel .segment");s.eq(0).css("padding",5);s.css("overflow",
"auto");var m=this.view.find("#cameraPanel .segment");m.css("overflow","auto");var n=this.view.find(".menu.tabular").outerHeight();$(window).resize(b);b();this.toggleLeft=function(){h.trigger("click")};this.toggleRight=function(){j.trigger("click")}};GlobalEditor.MainLayout.Event={RESIZE:"mainLayoutResizeEvent"};
GlobalEditor.TopMenu=function(a){function b(){$.each(d,function(){this.update()})}function c(a){function b(){if(d!="")GlobalEditor.KeyboardManager.execute(d);else switch(c){case "\u5728\u7ebf\u6587\u4ef6":GlobalEditor.KeyboardManager.execute("onlineFile");break;case "\u5bfc\u51fa\u56fe\u7247":GlobalEditor.KeyboardManager.execute("export");break;case "\u952e\u76d8\u5feb\u6377\u952e":GlobalEditor.KeyboardManager.execute("showQuickKey");break;case "\u7f16\u8f91\u6570\u636e\u6e90":GlobalEditor.KeyboardManager.execute("editDataSource");
break;case "\u5220\u9664\u6570\u636e\u6e90":GlobalEditor.KeyboardManager.execute("delDataSource");break;case "\u7f16\u8f91\u56fe\u5c42":GlobalEditor.KeyboardManager.execute("editImageLayer");break;case "\u5220\u9664\u56fe\u5c42":GlobalEditor.KeyboardManager.execute("delImageLayer");break;case "\u5173\u4e8eGlobalEditor":GlobalEditor.KeyboardManager.execute("about");break;case "\u7ec4\u4ef6\u7f16\u8f91\u5668":window.open("componentEditor.html");break;case "\u7559\u8a00":window.open("message.html")}}
var c=a.find("span.text").eq(0).text();a.find(".item").length==0&&a.click(b);var d=a.find("span.description").text();this.update=function(){var b=!0;switch(c){case "\u64a4\u6d88":b=GlobalEditor.historyPanel.getUndoAble();break;case "\u91cd\u505a":b=GlobalEditor.historyPanel.getRedoAble();break;case "\u5220\u9664":b=GlobalEditor.leftPanel.getComponentContainer().getSelectedItem()!=null;break;case "\u590d\u5236":b=GlobalEditor.leftPanel.getComponentContainer().getSelectedItem()!=null;break;case "\u526a\u5207":b=
GlobalEditor.leftPanel.getComponentContainer().getSelectedItem()!=null;break;case "\u7c98\u8d34":b=GlobalEditor.Clipboard.targets.length>0;break;case "\u7f16\u8f91\u6570\u636e\u6e90":b=GlobalEditor.dataSourcePanel.getSelectedItem()!=null;break;case "\u5220\u9664\u6570\u636e\u6e90":b=GlobalEditor.dataSourcePanel.getSelectedItem()!=null;break;case "\u7f16\u8f91\u56fe\u5c42":b=GlobalEditor.imageLayerPanel.getSelectedItem()!=null;break;case "\u5220\u9664\u56fe\u5c42":b=GlobalEditor.imageLayerPanel.getSelectedItem()!=
null;break;case "\u98de\u5230\u9009\u62e9\u7684\u76ee\u6807":b=GlobalEditor.editorContainer.viewer.selectedEntity!=null;break;case "\u5c5e\u6027\u9762\u677f":b=GlobalEditor.topMenu.panelMenuController.getSelectedValue()!="properties";break;case "\u5386\u53f2\u8bb0\u5f55":b=GlobalEditor.topMenu.panelMenuController.getSelectedValue()!="history";break;case "\u6570\u636e\u6e90":a.find(".menu").length==0&&(b=GlobalEditor.topMenu.panelMenuController.getSelectedValue()!="dataSource");break;case "\u5730\u5f62":b=
GlobalEditor.topMenu.panelMenuController.getSelectedValue()!="terrain";break;case "\u56fe\u5c42":a.find(".menu").length==0&&(b=GlobalEditor.topMenu.panelMenuController.getSelectedValue()!="imageLayer");break;case "\u6444\u76f8\u673a":b=GlobalEditor.topMenu.panelMenuController.getSelectedValue()!="camera"}this.setEnabled(b)};this.setEnabled=function(b){b?a.removeClass("disabled"):a.addClass("disabled")}}this.view=$(a);a=this.view.find(".ui.dropdown:not(.right.menu .ui.dropdown)");a.dropdown({on:"hover",
onShow:function(){b()}});var e=a.find(".item"),d=[];e.each(function(){d.push(new c($(this)))});this.panelMenuController=new function(a){var b,c={properties:$("#propertiesPanel"),history:$("#historyPanel"),dataSource:$("#dataSourcePanel"),terrain:$("#terrainPanel"),imageLayer:$("#imageLayerPanel"),camera:$("#cameraPanel")};$.each(c,function(){$(this).css("display","none")});this.selectValue=function(b){a.dropdown("set selected",b)};this.getSelectedValue=function(){return b};this.getMenu=function(){return a};
a.dropdown({onChange:function(a){b!=void 0&&c[b].css("display","none");b=a;c[b].css("display","block")}});this.selectValue("properties")}(this.view.find(".right.menu .ui.dropdown").eq(0));this.getItems=function(){return e}};
GlobalEditor.PropertiesPanel=function(){this.view=$("#propertiesPanel");this.header=this.view.find("#header");this.form=this.view.find(".ui.form");this.layoutPanel=this.view.find("#layoutPanel");this.setTargets=function(a){this.clear();a.length==1&&a[0].descriptor.init(this)};this.update=function(){var a=GlobalEditor.leftPanel.getComponentContainer().getSelectedItem();a!=null?this.setTargets([a.component]):this.setTargets([GlobalEditor.ToolManager.getTools()[0]])};this.clearPanel=function(){this.view.find(".ui.dropdown").dropdown("hide");
this.header.text("");this.form.empty()};this.clear=function(){this.clearPanel();this.layoutPanel.empty()}};
GlobalEditor.HistoryPanel=function(){function a(){var a=GlobalEditor.HistoryManager.items.length,b=GlobalEditor.HistoryManager.idx;a==0?(e.addClass("disabled"),d.addClass("disabled"),f.addClass("disabled")):(f.removeClass("disabled"),b==a-1?(d.addClass("disabled"),e.removeClass("disabled")):(b==-1?e.addClass("disabled"):e.removeClass("disabled"),d.removeClass("disabled")));g.empty();a=GlobalEditor.HistoryManager.items.length;if(a==0)g.text("\u6ca1\u6709\u4efb\u4f55\u5386\u53f2\u8bb0\u5f55");else for(var b=
[],c=GlobalEditor.HistoryManager.idx,k=0;k<a;k++){var l=new GlobalEditor.HistoryItemView(GlobalEditor.HistoryManager.items[k]);l.view.prependTo(g);b.push(l);k==c&&b[k].view.addClass("active")}}var b=$("#historyPanel"),c=b.find(".ui.tab.segment .menu .item"),e=c.eq(0),d=c.eq(1),f=c.eq(2),g=b.find(".ui.tab.segment .list");a();e.click(function(){GlobalEditor.HistoryManager.undo()});d.click(function(){GlobalEditor.HistoryManager.redo()});f.click(function(){GlobalEditor.HistoryManager.removeAll()});$(document).bind(GlobalEditor.HistoryManager.UPDATE,
a);this.getUndoAble=function(){return!e.hasClass("disabled")};this.getRedoAble=function(){return!d.hasClass("disabled")}};
GlobalEditor.HistoryItemView=function(a){var b={switchTool:{icon:"check circle icon",label:"\u5207\u6362\u4e86\u5de5\u5177"},edit:{icon:"edit icon",label:"\u7f16\u8f91\u4e86\u5143\u7d20"},copy:{icon:"copy icon",label:"\u590d\u5236\u4e86\u5143\u7d20"},paste:{icon:"paste icon",label:"\u7c98\u8d34\u4e86\u5143\u7d20"},cut:{icon:"cut icon",label:"\u526a\u5207\u4e86\u5143\u7d20"},addDataSource:{icon:"add circle icon",label:"\u6dfb\u52a0\u4e86\u6570\u636e\u6e90"},delDataSource:{icon:"trash icon",label:"\u5220\u9664\u4e86\u6570\u636e\u6e90"},
editDataSource:{icon:"edit icon",label:"\u7f16\u8f91\u4e86\u6570\u636e\u6e90"},addImageLayer:{icon:"add circle icon",label:"\u6dfb\u52a0\u4e86\u56fe\u5c42"},delImageLayer:{icon:"trash icon",label:"\u5220\u9664\u4e86\u56fe\u5c42"},editImageLayer:{icon:"edit icon",label:"\u7f16\u8f91\u4e86\u56fe\u5c42"},addComponent:{icon:"add circle icon",label:"\u6dfb\u52a0\u4e86\u7ec4\u4ef6"},editComponent:{icon:"edit icon",label:"\u7f16\u8f91\u4e86\u7ec4\u4ef6"},delComponent:{icon:"trash icon",label:"\u5220\u9664\u4e86\u7ec4\u4ef6"}};
this.view=$('<div class="item"></div>');this.icon=$('<i class="'+b[a.type].icon+'"></i>');this.content=$('<div class="content"><div class="header">'+b[a.type].label+"</div></div>");this.icon.appendTo(this.view);this.content.appendTo(this.view);this.view.click(function(){GlobalEditor.HistoryManager.go(a)})};
GlobalEditor.DataSourcePanel=function(){var a=this,b=$("#dataSourcePanel"),c=b.find(".ui.tab.segment .menu .item"),e=c.eq(0),c=c.eq(1),d=b.find("#itemContainer"),f=[],g=null,h=!1;e.click(function(){a.newItem()});c.click(function(){a.setEditMode(!h)});this.newItem=function(){GlobalEditor.editDataSourceWin.openForNew({onSubmit:function(a){GlobalEditor.GeneralManager.addDataSource(a)}})};this.addItem=function(a){a.view.appendTo(d);f.push(a);h&&a.closeBt.show()};this.addItemAt=function(a,b){b<=f.length-
1?(a.view.insertBefore(f[b].view),f.splice(b,0,a),h&&a.closeBt.show()):this.addItem(a)};this.removeItem=function(a){var b=f.indexOf(a);f.splice(b,1);a.view.detach()};this.getSelectedItem=function(){return g};this.getItems=function(){return f};this.selectItem=function(a){g!=null&&g.setSelected(!1);g=a;g!=null&&g.setSelected(!0)};this.setEditMode=function(a){f.length==0&&a||($.each(f,function(){this.closeBt[a?"show":"hide"]()}),h=a)};this.editItem=function(a){GlobalEditor.editDataSourceWin.openForEdit(a.info,
{onSubmit:function(b){GlobalEditor.GeneralManager.updateDataSource(a,b)}})};this.editSelectedItem=function(){this.editItem(g)};this.delSelectedItem=function(){GlobalEditor.GeneralManager.removeDataSource(g)};this.getSettings=function(){var a={selectedIdx:-1,items:[]};a.selectedIdx=f.indexOf(g);$.each(f,function(){a.items.push(this.getSettings())});return a};this.setSettings=function(b){$.each(b.items,function(){var b=this.info,c=new GlobalEditor.DataSource(b),b=new GlobalEditor.DataSourceEditItem(b,
c);GlobalEditor.DataSourceManager.add(c);a.addItem(b);this.isActive||b.setActive(this.isActive)});b.selectedIdx>-1&&this.selectItem(f[b.selectedIdx])};this.clear=function(){for(;f.length>0;){var b=f[0];a.removeItem(b);GlobalEditor.DataSourceManager.remove(b.dataSource)}this.selectItem(null);h=null}};
GlobalEditor.SettingWin=function(a){function b(a,b){this.setDisplay=function(c){a.css("display",c?"block":"none");b.css("display",c?"block":"none")}}var c=this;this.view=$(a);var e=this.view.find(".ui.menu .item"),a=this.view.find(".content").eq(0).children(),d=this.view.find(".actions").eq(0).children(),f=[new function(a,c){b.call(this,a,c);var d=this,e=a.find("input").eq(0),f=c.find("button").eq(0);this.getMaxHistory=function(){return GlobalEditor.HistoryManager.maxLen};this.setMaxHistory=function(a){GlobalEditor.HistoryManager.maxLen=
a};this.initValues=function(){e.val(this.getMaxHistory())};this.initValues();f.click(function(){d.setMaxHistory(e.val())})}(a.eq(0),d.eq(0)),new function(a,c){b.call(this,a,c);var d='<table class="ui celled table">';d+=" <thead><tr>";d+="  <th>\u5feb\u6377\u952e</th>";d+="  <th>\u8bf4\u660e</th>";d+=" </tr></thead>";d+=" <tbody>";GlobalEditor.topMenu.getItems().each(function(){if($(this).find(".item").length==0){var a=$(this).find("span.text").text(),b=$(this).find("span.description").text();b!=""&&
(d+="<tr><td>"+b+"</td><td>"+a+"</td></tr>")}});d+=" </tbody>";d+="</table>";$(d).appendTo(a)}(a.eq(1),d.eq(1)),new function(a,c){b.call(this,a,c);var d=this,e=$("<audio>",{src:"assets/sounds/m01.m4a",loop:!0}),f=a.find(".icon.music");f.addClass("red");f.click(function(){f.toggleClass("red");f.hasClass("red")?d.playMusic():d.stopMusic()});var g=this.setDisplay;this.setDisplay=function(b){g.call(this,b);a.parent().css("background-color",b?"#000000":"#ffffff");b?this.playMusic():this.stopMusic()};this.playMusic=
function(){f.hasClass("red")&&e.get(0).play()};this.stopMusic=function(){e.get(0).pause();e.get(0).currentTime=0};a.children().eq(2).text("GlobalEditor "+GlobalEditor.Settings.version);var o='<div style="color:#999999;text-align: center;">'+Base64.decode("Qmxhbms=")+"</div>";o+='<div style="color:#999999;text-align: center;">'+Base64.decode("aGVyb2JsYW5rQGdtYWlsLmNvbQ==")+"</div>";$(o).appendTo(a)}(a.eq(2),d.eq(2))],g=-1;e.each(function(a){$(this).click(function(){c.selectTabIdx(a)})});this.view.modal({onHide:function(){f[2].stopMusic()}});
this.show=function(a){f[0].initValues();this.selectTabIdx(a);this.view.modal("show")};this.selectTabIdx=function(a){g>-1&&(e.eq(g).removeClass("active blue"),f[g].setDisplay(!1));e.eq(a).addClass("active blue");g=a;f[a].setDisplay(!0);this.view.modal("refresh")}};
GlobalEditor.ButtonGroupSwitcher=function(a,b){var c=this,e=a.find("button"),d=-1,f=[];e.each(function(a,b){$(b).click(function(){if(d!=a&&(c.selectIdx(a),c.onChange!=void 0))c.onChange(c.getValue())});f.push($(b).attr("data-value"))});this.selectIdx=function(a){d>-1&&e.eq(d).removeClass("active");d=a;e.eq(a).addClass("active")};this.setValue=function(a){this.selectIdx(f.indexOf(a))};this.getValue=function(){return f[d]};b!=void 0&&this.setValue(b)};
GlobalEditor.Dropdown=function(a,b){var c=this;this.view=GlobalEditor.FormViewManager.createDropdownView(a,b);this.dropdown=this.view.find(".ui.dropdown");this.fireChangeEvent=!0;this.dropdown.dropdown({onChange:function(a,b,f){if(c.onChange!=void 0&&c.fireChangeEvent)c.onChange(a,b,f)}});this.setValue=function(a){this.fireChangeEvent=!1;this.dropdown.dropdown("set selected",a.toString());this.fireChangeEvent=!0}};
GlobalEditor.ColorPicker=function(a,b){var c=this;this.view=b;this.view.val(a);this.view.colorPicker({animationSpeed:0,renderCallback:function(a,b){if(b!=!0)if(b==!1){if(c.onSubmit!=void 0)c.onSubmit(a.val())}else if(b==void 0&&c.onChange!=void 0)c.onChange(a.val())}});this.setColor=function(a){this.view.val(a);this.view.css("background-color",a)}};
GlobalEditor.Slider=function(a,b,c,e){var d=this,f=a.find(".ui.slider").get(0);noUiSlider.create(f,{start:[e],range:{min:[b],max:[c]}});var g=a.find("input").get(0);f.noUiSlider.on("update",function(a,b){var c=a[b];g.value=c;if(d.onUpdate!=void 0)d.onUpdate(c)});g.addEventListener("change",function(){f.noUiSlider.set(this.value);if(d.onChange!=void 0)d.onChange(this.value)});f.noUiSlider.on("change",function(){var a=d.getValue();if(d.onChange!=void 0)d.onChange(a)});this.getValue=function(){return f.noUiSlider.get()};
this.setValue=function(a){f.noUiSlider.set(a)}};
GlobalEditor.InputWin=function(a){var b=$(a),c=b.find(".header i").eq(0),e=b.find(".header label").eq(0),d=b.find("input").eq(0),f=b.find(".right.labeled .label").eq(0),g=b.find(".actions button").eq(0),h;g.click(function(){g.addClass("disabled");b.modal("hide");h!=void 0&&h(d.val())});this.setOption=function(a){c.attr("class",a.icon);e.text(a.title);d.attr("placeholder",a.placeholder);f.text(a.rightlabel);g.text(a.submitLabel);d.val(a.value);h=a.onSubmit};this.show=function(a){this.setOption(a);
g.removeClass("disabled");b.modal("show")}};
GlobalEditor.Alert=function(){var a={},b=$("<div class='ui small modal'>");$("<div class='header'><i class='warning circle icon'></i><label>\u63d0\u793a</label></div>").appendTo(b);var c=$("<div class='content'>");c.appendTo(b);var e=$("<div class='actions'>");e.appendTo(b);var d=$('<button class="ui primary button">'),f=$('<button class="ui button">');d.click(function(){d.addClass("disabled");b.modal("hide");if(a.onSubmit!=void 0)a.onSubmit()});f.click(function(){f.addClass("disabled");b.modal("hide")});
a.show=function(g,h,j,i){d.removeClass("disabled");f.removeClass("disabled");d.detach();f.detach();d.text("Submit");f.text("Cancel");h!=void 0&&(d.text(h),d.appendTo(e));j!=void 0&&(f.text(j),f.appendTo(e));a.onSubmit=i;c.text(g);b.modal("show")};return a}();
GlobalEditor.OnlineFileWin=function(a){function b(a){var b;b='<div class="ui image" style="border: solid 1px #E3E3E3;float: left;margin-left: 10px;margin-top: 10px;width:240px;height:180px;padding:1px;">';b+='<div class="ui dimmer">';b+='<div class="content">';b+='<div class="center">';b+='<h2 class="ui inverted header">'+a+"</h2>";b+='<div class="ui button">\u6253\u5f00\u6587\u4ef6</div>';b+="</div>";b+="</div>";b+="</div>";b+='<div style="width:100%;height:100%;background-image:url('+("examples/"+
a+"/"+a+".png")+');background-size:contain;background-repeat:no-repeat;background-origin:content;background-position:50% 50%;"></div>';b+="</div>";this.view=$(b);this.view.dimmer({on:"hover"});var d=this.view.find(".ui.dimmer .ui.button").eq(0);d.click(function(){c.openFile(a);d.addClass("disabled")});this.reset=function(){d.removeClass("disabled")}}var c=this,e=$(a),d=e.find(".content").eq(0),f=!1,g=[];this.show=function(){f?(this.reset(),e.modal("show")):($("#loadingMask").dimmer({closable:!1}),
$("#loadingMask").find(".ui.text.loader").text("\u5217\u8868\u8bfb\u53d6\u4e2d..."),$("#loadingMask").dimmer("show"),$.getJSON("examples/list.json",function(a){$("#loadingMask").dimmer("hide");for(var c=0;c<a.length;c++){var i=new b(a[c]);i.view.prependTo(d);g.push(i)}f=!0;e.modal("show")}))};this.reset=function(){for(var a=0;a<g.length;a++)g[a].reset()};this.openFile=function(a){e.modal("hide");a="examples/"+a+"/"+a+".ge";$("#loadingMask").dimmer({closable:!1});$("#loadingMask").find(".ui.text.loader").text("\u6570\u636e\u8bfb\u53d6\u4e2d...");
$("#loadingMask").dimmer("show");$.get(a,function(a){$("#loadingMask").dimmer("hide");GlobalEditor.File.openSavedData(a)})}};
GlobalEditor.EditDataSourceWin=function(a){function b(a){a=l.indexOf(a);h.eq(a).checkbox("set checked")}function c(a){a=q.indexOf(a);j.eq(a).checkbox("set checked");$.each([o,r,u],function(){this.hide()});a<q.length-1&&[o,r,u][a].show();a==2&&e();g.modal("refresh")}function e(){p==void 0&&(p=CodeMirror.fromTextArea(t.get(0),{mode:"javascript",lineNumbers:!0,textWrapping:!0,theme:"tomorrow-night-bright"}),p.on("change",function(){t.val(p.doc.getValue())}));p.doc.setValue(t.val())}function d(){k.removeClass("disabled");
s.val("");m.val("");n.val("");t.val("")}var f=this,g=$(a),a=g.find(".content .form").children(),h=a.eq(1).find(".ui.radio.checkbox").checkbox(),j=a.eq(2).find(".ui.radio.checkbox").checkbox(),i=g.find(".header label"),k=g.find(".actions button").eq(0),l=["CZML","GeoJSON","TopoJSON","KML","Custom"],q=["string","url","js","blank"],o=a.eq(3),r=a.eq(4),u=a.eq(5),s=a.eq(0).find("input"),m=o.find("textarea"),n=r.find("input"),t=u.find("textarea"),p;h.checkbox({onChange:function(){var a=$(this).data("class");
b(a)}});j.checkbox({onChange:function(){var a=$(this).data("type");c(a)}});k.click(function(){k.addClass("disabled");var a={};a.name=s.val();a["class"]=h.closest(".checked").find("input").eq(0).data("class");a.type=j.closest(".checked").find("input").eq(0).data("type");var b=q.indexOf(a.type);b<q.length-1&&(a[a.type]=[m,n,t][b].val());f.handler.onSubmit(a);g.modal("hide")});this.openForNew=function(a){this.handler=a;i.text("\u6dfb\u52a0\u6570\u636e\u6e90");b("CZML");c("string");d();g.modal("show")};
this.openForEdit=function(a,f){this.handler=f;i.text("\u7f16\u8f91\u6570\u636e\u6e90 - "+a.name);b(a["class"]);c(a.type);d();s.val(a.name);var h=q.indexOf(a.type);h<q.length-1&&[m,n,t][h].val(a[a.type]);g.modal("show");h==2&&e()}};
GlobalEditor.EditItem=function(){var a='<div class="editItem">';a+='\t     <div class="box">';a+="\t       <span></span>";a+="\t     </div>";a+='\t     <div class="label"></div>';a+='\t     <button class="circular ui icon mini button close">';a+='\t       <i class="remove icon"></i>';a+="\t     </button>";a+='\t     <button class="circular ui icon mini button blue select">';a+='\t       <i class="check icon"></i>';a+="\t     </button>";a+="\t   </div>";this.view=$(a);this.box=this.view.find(".box");
this.closeBt=this.view.find("button").eq(0);this.selectIcon=this.view.find("button").eq(1);this.titleLabel=this.view.find(".label");this.spanCt=this.view.find(".box span").eq(0);this.selected=this.isActive=!1;this.closeBt.hide();this.selectIcon.hide();this.setTitle=function(a){this.titleLabel.text(a==""?"\u672a\u547d\u540d":a)};this.setActive=function(a){this.view[a?"addClass":"removeClass"]("active");this.isActive=a};this.setSelected=function(a){a?this.selectIcon.show():this.selectIcon.hide();this.selected=
a}};
GlobalEditor.DataSourceEditItem=function(a,b){GlobalEditor.EditItem.call(this);var c=this;this.info=a;this.dataSource=b;this.setClass=function(a,b){this.spanCt.empty();b=="js"?$("<img>",{src:"assets/image/icons/script.png"}).appendTo(this.spanCt):this.spanCt.text(a)};var e=this.setActive;this.setActive=function(a){e.call(this,a);this.dataSource.setActive(a)};this.updateInfo=function(a){this.info=a;this.setTitle(a.name);this.setClass(a["class"],a.type);this.dataSource.updateInfo(a)};this.setTitle(a.name);this.setClass(a["class"],
a.type);this.setActive(!0);this.box.mousedown(function(){function a(){b!=void 0&&(clearTimeout(b),c.closeBt.css("display")=="block"?GlobalEditor.dataSourcePanel.editItem(c):GlobalEditor.GeneralManager.setDataSourceActive(c,!c.isActive));$(document).off("mouseup",a)}$(document).on("mouseup",a);var b=setTimeout(function(){GlobalEditor.GeneralManager.selectDataSource(c);b=void 0;a()},1E3)});this.closeBt.click(function(){GlobalEditor.Alert.show("\u786e\u8ba4\u8981\u5220\u9664\u6570\u636e\u6e90 - "+c.titleLabel.text()+
" \u5417\uff1f","\u786e\u8ba4","\u53d6\u6d88",function(){GlobalEditor.GeneralManager.removeDataSource(c)})});this.getSettings=function(){var a={};a.info=GlobalEditor.ObjectUtil.clone(this.info);a.isActive=this.isActive;return a}};
GlobalEditor.TerrainPanel=function(a){this.view=$(a);this.form=this.view.find(".ui.form");this.header=$("<div>");var a=new GlobalEditor.Terrain,b=new GlobalEditor.TerrainDescriptor(a);b.init(this);this.getSettings=function(){return b.getSettings()};this.setSettings=function(a){b.setSettings(a);this.update()};this.clear=function(){b.clear();this.update()};this.update=function(){this.clearPanel();b.init(this)};this.clearPanel=function(){GlobalEditor.propertiesPanel.clearPanel.call(this)}};
GlobalEditor.ImageLayerPanel=function(a){var b=this;this.view=$(a);this.form=this.view.find(".ui.form");this.header=$("<div>");var c=this.view.find(".ui.tab.segment .menu .item"),a=c.eq(0),c=c.eq(1),e=this.view.find("#layerContainer"),d=[],f=null,g=!1;a.click(function(){b.newItem()});c.click(function(){b.setEditMode(!g)});this.newItem=function(){GlobalEditor.editImageLayerWin.openForNew({onSubmit:function(a){GlobalEditor.GeneralManager.addImageLayer(a)}})};this.addItem=function(a){a.view.appendTo(e);
d.push(a);g&&a.setEditMode(!0)};this.addDefaultItem=function(a){GlobalEditor.editorContainer.viewer.imageryLayers.removeAll();var a={name:"\u9ed8\u8ba4\u56fe\u5c42",js:"new Cesium.BingMapsImageryProvider({url:'https://dev.virtualearth.net'})"},b=new GlobalEditor.ImageLayer(a);GlobalEditor.ImageLayerManager.add(b);a=new GlobalEditor.EditImageLayerItem(a,b);this.addItem(a)};this.addItemAt=function(a,b){b<=d.length-1?(a.view.insertBefore(d[b].view),d.splice(b,0,a),g&&a.setEditMode(!0)):this.addItem(a)};
this.removeItem=function(a){var b=d.indexOf(a);d.splice(b,1);a.view.detach()};this.moveItemUp=function(a){var b=d.indexOf(a),c=b-1,e=d[c];d.splice(b,1);d.splice(c,0,a);a.view.insertBefore(e.view)};this.moveItemDown=function(a){var b=d.indexOf(a),c=b+1,e=d[c];d.splice(b,1);d.splice(c,0,a);a.view.insertAfter(e.view)};this.getSelectedItem=function(){return f};this.getItems=function(){return d};this.selectItem=function(a){f!=null&&f.setSelected(!1);f=a;f!=null&&f.setSelected(!0)};this.setEditMode=function(a){d.length==
0&&a||($.each(d,function(){this.setEditMode(a)}),g=a)};this.editItem=function(a){GlobalEditor.editImageLayerWin.openForEdit(a.info,{onSubmit:function(b){GlobalEditor.GeneralManager.updateImageLayer(a,b)}})};this.editSelectedItem=function(){this.editItem(f)};this.delSelectedItem=function(){GlobalEditor.GeneralManager.removeImageLayer(f)};this.setTarget=function(a){this.clearPanel();a!=null&&a.imageLayer.imageLayerAdjustDescriptor.init(this)};this.clearPanel=function(){GlobalEditor.propertiesPanel.clearPanel.call(this)};
this.getSettings=function(){var a={selectedIdx:-1,items:[]};a.selectedIdx=d.indexOf(f);$.each(d,function(){a.items.push(this.getSettings())});return a};this.setSettings=function(a){$.each(a.items,function(){var a=this.info,c=new GlobalEditor.ImageLayer(a),a=new GlobalEditor.EditImageLayerItem(a,c);b.addItem(a);GlobalEditor.ImageLayerManager.add(c);c.imageLayerAdjust.setSettings(this.adjust)});a.selectedIdx>-1&&(a=d[a.selectedIdx],this.selectItem(a),this.setTarget(a))};this.clear=function(){for(;d.length>
0;){var a=d[0];b.removeItem(a);GlobalEditor.ImageLayerManager.remove(a.imageLayer)}this.selectItem(null);this.setTarget(null);g=null};this.addDefaultItem()};
GlobalEditor.EditImageLayerWin=function(a){function b(){i==void 0&&(i=CodeMirror.fromTextArea(j.get(0),{mode:"javascript",lineNumbers:!0,textWrapping:!0,theme:"tomorrow-night-bright"}),d.modal("refresh"),i.on("change",function(){j.val(i.doc.getValue())}));i.doc.setValue(j.val())}function c(){g.removeClass("disabled");h.val("");j.val("")}var e=this,d=$(a),f=d.find(".header label"),g=d.find(".actions button").eq(0),h=d.find("input"),j=d.find("textarea"),i;g.click(function(){g.addClass("disabled");var a=
{};a.name=h.val();a.js=j.val();e.handler.onSubmit(a);d.modal("hide")});this.openForNew=function(a){this.handler=a;f.text("\u6dfb\u52a0\u56fe\u5c42");c();d.modal("show");b()};this.openForEdit=function(a,e){this.handler=e;f.text("\u7f16\u8f91\u56fe\u5c42 - "+a.name);c();h.val(a.name);j.val(a.js);d.modal("show");b()}};
GlobalEditor.EditImageLayerItem=function(a,b){var c=this;this.info=a;this.imageLayer=b;var e='<div class="layerEditItem">';e+='\t  <button class="circular ui icon mini button delBt">';e+='\t\t<i class="remove icon"></i>';e+="\t  </button>";e+="   <label></label>";e+='   <button class="ui icon mini button upBt">';e+='     <i class="arrow up icon"></i>';e+="   </button>";e+='   <button class="ui icon mini button downBt">';e+='     <i class="arrow down icon"></i>';e+="   </button>";e+="</div>";this.view=
$(e);this.selected=this.editMode=!1;this.titleLabel=this.view.find("label").eq(0);e=this.view.find("button");this.closeBt=e.eq(0);this.upBt=e.eq(1);this.downBt=e.eq(2);this.closeBt.click(function(a){a.stopImmediatePropagation();GlobalEditor.Alert.show("\u786e\u8ba4\u8981\u5220\u9664\u56fe\u5c42 - "+c.titleLabel.text()+" \u5417\uff1f","\u786e\u8ba4","\u53d6\u6d88",function(){GlobalEditor.GeneralManager.removeImageLayer(c)})});this.upBt.click(function(a){a.stopImmediatePropagation();GlobalEditor.GeneralManager.moveImageLayerUp(c)});
this.downBt.click(function(a){a.stopImmediatePropagation();GlobalEditor.GeneralManager.moveImageLayerDown(c)});this.view.click(function(){c.editMode?GlobalEditor.imageLayerPanel.editItem(c):GlobalEditor.GeneralManager.selectImageLayer(c)});this.setEditMode=function(a){this.view[a?"addClass":"removeClass"]("edit");this.editMode=a};this.setTitle=function(a){this.titleLabel.text(a==""?"\u672a\u547d\u540d":a)};this.setSelected=function(a){this.view[a?"addClass":"removeClass"]("selected");this.selected=
a};this.updateInfo=function(a){this.info=a;this.setTitle(a.name);this.imageLayer.updateInfo(a)};this.setTitle(a.name);this.getSettings=function(){var a={};a.info=GlobalEditor.ObjectUtil.clone(this.info);a.adjust=GlobalEditor.ObjectUtil.clone(this.imageLayer.imageLayerAdjust.settings);return a}};
GlobalEditor.CameraPanel=function(a){function b(){f=Cesium.requestAnimationFrame(b);d.update()}var a=$(a).find(".ui.form"),c=GlobalEditor.editorContainer.viewer.camera,e=new GlobalEditor.CameraDelegate(c),d=new GlobalEditor.CameraDataModel(e);d.createTo(a);var f;c.moveStart.addEventListener(function(){b()});c.moveEnd.addEventListener(function(){cancelAnimationFrame(f)})};
GlobalEditor.EditMaterialWin=function(a){function b(){l.removeClass("disabled");$.each(k,function(){this.reset()});j.dropdown("set selected",(0).toString())}function c(a,b){for(key in a)key!="className"&&(a[key]=b[key])}function e(a,b){function c(){var a={x:Number(f.val()),y:Number(g.val())};if(d.onChange!=void 0)d.onChange(a)}var d=this,e=a.find("input"),f=e.eq(0),g=e.eq(1);f.val(b.x);g.val(b.y);f.change(function(){c()});g.change(function(){c()});this.setPosition=function(a){f.val(a.x);g.val(a.y)}}
var d=this,f=["ColorMaterialProperty","CompositeMaterialProperty","GridMaterialProperty","ImageMaterialProperty","PolylineGlowMaterialProperty","PolylineOutlineMaterialProperty","StripeMaterialProperty"],g={ColorMaterialProperty:{color:"#ffffff"},CompositeMaterialProperty:{},GridMaterialProperty:{color:"#ffffff",cellAlpha:1,lineCount:{x:8,y:8},lineThickness:{x:1,y:1},lineOffset:{x:0,y:0}},ImageMaterialProperty:{image:"",repeat:{x:1,y:1},color:"#ffffff",transparent:!1},PolylineGlowMaterialProperty:{color:"#ffffff",
glowPower:0.25},PolylineOutlineMaterialProperty:{color:"#ffffff",outlineColor:"#000000",outlineWidth:1},StripeMaterialProperty:{evenColor:"#ffffff",oddColor:"#000000",repeat:1,offset:0,orientation:0}},h=$(a),j=h.find(".ui.dropdown").eq(0),i=h.find("#tab0,#tab1,#tab2,#tab3,#tab4,#tab5,#tab6"),k=[new function(a,b){var d=GlobalEditor.ObjectUtil.clone(b),e=a.find(".colorPicker").eq(0),g=new GlobalEditor.ColorPicker(d.color,e);g.onChange=function(a){d.color=a};this.reset=function(){d.color=b.color;g.setColor(d.color)};
this.setValue=function(a){a=this.encode(a);c(d,a);g.setColor(d.color)};this.getValue=function(){return this.decode(d)};this.show=function(){a.show()};this.encode=function(a){return{className:f[0],color:GlobalEditor.CesiumUtil.getPropertyValue(a.color).toCssColorString()}};this.decode=function(a){a=Cesium.Color.fromCssColorString(a.color);return new Cesium.ColorMaterialProperty(a)}}(i.eq(0),g.ColorMaterialProperty),new function(a){this.reset=function(){};this.setValue=function(){};this.getValue=function(){return this.decode()};
this.show=function(){a.show()};this.encode=function(){return{className:f[1]}};this.decode=function(){return new Cesium.CompositeMaterialProperty}}(i.eq(1),g.CompositeMaterialProperty),new function(a,b){var d=GlobalEditor.ObjectUtil.clone(b),g=a.find(".colorPicker").eq(0),h=new GlobalEditor.ColorPicker(d.color,g);h.onChange=function(a){d.color=a};var g=a.children().eq(1),j=new GlobalEditor.Slider(g,0,1,d.cellAlpha);j.onChange=function(a){d.cellAlpha=Number(a)};var g=a.children().eq(2),i=a.children().eq(3),
k=a.children().eq(4),p=new e(g,d.lineCount),l=new e(i,d.lineThickness),v=new e(k,d.lineOffset);p.onChange=function(a){d.lineCount=a};l.onChange=function(a){d.lineThickness=a};v.onChange=function(a){d.lineOffset=a};this.reset=function(){d.color=b.color;d.cellAlpha=b.cellAlpha;d.lineCount=b.lineCount;d.lineThickness=b.lineThickness;d.lineOffset=b.lineOffset;h.setColor(d.color);j.setValue(d.cellAlpha);p.setPosition(d.lineCount);l.setPosition(d.lineThickness);v.setPosition(d.lineOffset)};this.setValue=
function(a){a=this.encode(a);c(d,a);h.setColor(d.color);j.setValue(d.cellAlpha);p.setPosition(d.lineCount);l.setPosition(d.lineThickness);v.setPosition(d.lineOffset)};this.getValue=function(){return this.decode(d)};this.show=function(){a.show()};this.encode=function(a){return{className:f[2],color:a.color==void 0?b.color:GlobalEditor.CesiumUtil.getPropertyValue(a.color).toCssColorString(),cellAlpha:a.cellAlpha==void 0?b.cellAlpha:GlobalEditor.CesiumUtil.getPropertyValue(a.cellAlpha),lineCount:a.lineCount==
void 0?b.lineCount:e.getPosition(GlobalEditor.CesiumUtil.getPropertyValue(a.lineCount)),lineThickness:a.lineThickness==void 0?b.lineThickness:e.getPosition(GlobalEditor.CesiumUtil.getPropertyValue(a.lineThickness)),lineOffset:a.lineOffset==void 0?b.lineOffset:e.getPosition(GlobalEditor.CesiumUtil.getPropertyValue(a.lineOffset))}};this.decode=function(a){a={color:Cesium.Color.fromCssColorString(a.color),cellAlpha:a.cellAlpha,lineCount:e.toCartesian2(a.lineCount),lineThickness:e.toCartesian2(a.lineThickness),
lineOffset:e.toCartesian2(a.lineOffset)};return new Cesium.GridMaterialProperty(a)}}(i.eq(2),g.GridMaterialProperty),new function(a,b){var d=GlobalEditor.ObjectUtil.clone(b),g=a.find(".colorPicker").eq(0),h=new GlobalEditor.ColorPicker(d.color,g);h.onChange=function(a){d.color=a};var j=a.find(".ui.checkbox").eq(0);j.checkbox({onChange:function(){var a=j.checkbox("is checked");d.transparent=a}});var i=a.children().eq(0).find("input").eq(0);i.change(function(){d.image=i.val()});var g=a.children().eq(1),
k=new e(g,d.repeat);k.onChange=function(a){d.repeat=a};this.reset=function(){d.image=b.image;d.repeat=b.repeat;d.color=b.color;d.transparent=b.transparent;i.val(d.image);k.setPosition(d.repeat);h.setColor(d.color);j.checkbox(d.transparent?"set checked":"set unchecked")};this.setValue=function(a){a=this.encode(a);c(d,a);i.val(d.image);k.setPosition(d.repeat);h.setColor(d.color);j.checkbox(d.transparent?"set checked":"set unchecked")};this.getValue=function(){return this.decode(d)};this.show=function(){a.show()};
this.encode=function(a){return{className:f[3],image:a.image==void 0?b.image:GlobalEditor.CesiumUtil.getPropertyValue(a.image),repeat:a.repeat==void 0?b.repeat:e.getPosition(GlobalEditor.CesiumUtil.getPropertyValue(a.repeat)),color:a.color==void 0?b.color:GlobalEditor.CesiumUtil.getPropertyValue(a.color).toCssColorString(),transparent:a.transparent==void 0?b.transparent:GlobalEditor.CesiumUtil.getPropertyValue(a.transparent)}};this.decode=function(a){a={image:a.image,repeat:e.toCartesian2(a.repeat),
color:Cesium.Color.fromCssColorString(a.color),transparent:a.transparent};return new Cesium.ImageMaterialProperty(a)}}(i.eq(3),g.ImageMaterialProperty),new function(a,b){var d=GlobalEditor.ObjectUtil.clone(b),e=a.find(".colorPicker").eq(0),g=new GlobalEditor.ColorPicker(d.color,e);g.onChange=function(a){d.color=a};var e=a.children().eq(1),h=new GlobalEditor.Slider(e,0,1,d.glowPower);h.onChange=function(a){d.glowPower=a};this.reset=function(){d.color=b.color;d.glowPower=b.glowPower;g.setColor(d.color);
h.setValue(d.glowPower)};this.setValue=function(a){a=this.encode(a);c(d,a);g.setColor(d.color);h.setValue(d.glowPower)};this.getValue=function(){return this.decode(d)};this.show=function(){a.show()};this.encode=function(a){return{className:f[4],color:a.color==void 0?b.color:GlobalEditor.CesiumUtil.getPropertyValue(a.color).toCssColorString(),glowPower:a.glowPower==void 0?b.glowPower:GlobalEditor.CesiumUtil.getPropertyValue(a.glowPower)}};this.decode=function(a){a={color:Cesium.Color.fromCssColorString(a.color),
glowPower:a.glowPower};return new Cesium.PolylineGlowMaterialProperty(a)}}(i.eq(4),g.PolylineGlowMaterialProperty),new function(a,b){var d=GlobalEditor.ObjectUtil.clone(b),e=a.find(".colorPicker").eq(0),g=a.find(".colorPicker").eq(1),h=new GlobalEditor.ColorPicker(d.color,e);h.onChange=function(a){d.color=a};var j=new GlobalEditor.ColorPicker(d.outlineColor,g);j.onChange=function(a){d.outlineColor=a};var i=a.children().eq(2).find("input").eq(0);i.change(function(){d.outlineWidth=Number(i.val())});
this.reset=function(){d.color=b.color;d.outlineColor=b.outlineColor;d.outlineWidth=b.outlineWidth;h.setColor(d.color);j.setColor(d.outlineColor);i.val(d.outlineWidth)};this.setValue=function(a){a=this.encode(a);c(d,a);h.setColor(d.color);j.setColor(d.outlineColor);i.val(d.outlineWidth)};this.getValue=function(){return this.decode(d)};this.show=function(){a.show()};this.encode=function(a){return{className:f[5],color:a.color==void 0?b.color:GlobalEditor.CesiumUtil.getPropertyValue(a.color).toCssColorString(),
outlineColor:a.outlineColor==void 0?b.outlineColor:GlobalEditor.CesiumUtil.getPropertyValue(a.outlineColor).toCssColorString(),outlineWidth:a.outlineWidth==void 0?b.outlineWidth:GlobalEditor.CesiumUtil.getPropertyValue(a.outlineWidth)}};this.decode=function(a){a={color:Cesium.Color.fromCssColorString(a.color),outlineColor:Cesium.Color.fromCssColorString(a.outlineColor),outlineWidth:a.outlineWidth};return new Cesium.PolylineOutlineMaterialProperty(a)}}(i.eq(5),g.PolylineOutlineMaterialProperty),new function(a,
b){var d=GlobalEditor.ObjectUtil.clone(b),e=a.find(".colorPicker").eq(0),g=a.find(".colorPicker").eq(1),h=new GlobalEditor.ColorPicker(d.evenColor,e);h.onChange=function(a){d.evenColor=a};var j=new GlobalEditor.ColorPicker(d.oddColor,g);j.onChange=function(a){d.oddColor=a};var i=a.find(".ui.dropdown").eq(0);i.dropdown({onChange:function(a){d.orientation=Number(a)}});var k=a.children().eq(2).find("input").eq(0),l=a.children().eq(3).find("input").eq(0);k.change(function(){d.repeat=Number(k.val())});
l.change(function(){d.offset=Number(l.val())});this.reset=function(){d.evenColor=b.evenColor;d.oddColor=b.oddColor;d.repeat=b.repeat;d.offset=b.offset;d.orientation=b.orientation;h.setColor(d.evenColor);j.setColor(d.oddColor);k.val(d.repeat);l.val(d.offset);i.dropdown("set selected",d.orientation.toString())};this.setValue=function(a){a=this.encode(a);c(d,a);h.setColor(d.evenColor);j.setColor(d.oddColor);k.val(d.repeat);l.val(d.offset);i.dropdown("set selected",d.orientation.toString())};this.getValue=
function(){return this.decode(d)};this.show=function(){a.show()};this.encode=function(a){return{className:f[6],evenColor:a.evenColor==void 0?b.evenColor:GlobalEditor.CesiumUtil.getPropertyValue(a.evenColor).toCssColorString(),oddColor:a.oddColor==void 0?b.oddColor:GlobalEditor.CesiumUtil.getPropertyValue(a.oddColor).toCssColorString(),repeat:a.repeat==void 0?b.repeat:GlobalEditor.CesiumUtil.getPropertyValue(a.repeat),offset:a.offset==void 0?b.offset:GlobalEditor.CesiumUtil.getPropertyValue(a.offset),
orientation:a.orientation==void 0?b.orientation:GlobalEditor.CesiumUtil.getPropertyValue(a.orientation)}};this.decode=function(a){a={evenColor:Cesium.Color.fromCssColorString(a.evenColor),oddColor:Cesium.Color.fromCssColorString(a.oddColor),repeat:a.repeat,offset:a.offset,orientation:a.orientation};return new Cesium.StripeMaterialProperty(a)}}(i.eq(6),g.StripeMaterialProperty)];j.dropdown({onChange:function(a){a=Number(a);i.hide();k[a].show();h.modal("refresh")}});var l=h.find(".actions button").eq(0);
l.click(function(){l.addClass("disabled");var a;a=Number(j.dropdown("get value"));a=k[a].getValue();d.onSubmit(a);h.modal("hide")});i.hide();this.openForEditMaterial=function(a,c){this.onSubmit=c;b();if(a!=void 0){var e=d.getClassName(a),e=f.indexOf(e);j.dropdown("set selected",e.toString());k[e].setValue(a)}h.modal("show")};e.getPosition=function(a){return{x:a.x,y:a.y}};e.toCartesian2=function(a){return new Cesium.Cartesian2(a.x,a.y)};this.getClassNames=function(){return f};this.getClassName=function(a){for(var b=
a.constructor.name,c=0;c<f.length;c++){var d=f[c];if(a instanceof Cesium[d]){b=d;break}}return b};this.isMaterialProperty=function(a){a=this.getClassName(a);return f.indexOf(a)>-1};this.encode=function(a){var b=this.getClassName(a),b=f.indexOf(b);return k[b].encode(a)};this.decode=function(a){var b=f.indexOf(a.className);return k[b].decode(a)}};
GlobalEditor.ComponentBase=function(){this.descriptor=new GlobalEditor.ComponentBaseDescriptor(this);this.play=function(){};this.stop=function(){};this.getOptions=function(){return{}};this.cloneOptionsHandle=function(a){return a};this.clone=function(a){var b=GlobalEditor.ObjectUtil.clone(this.getOptions()),b=a==void 0?b:a(b),b=this.cloneOptionsHandle(b);return new this.constructor(b)}};
GlobalEditor.EditComponentItem=function(a,b){var c=this;this.component=b;GlobalEditor.DragItem.call(this,a.icon,{width:50,height:50});this.selected=!1;this.initEvents=function(){this.view.mousedown(function(){GlobalEditor.GeneralManager.selectComponent(c)})};this.setSelected=function(a){this.view[a?"addClass":"removeClass"]("selected");this.selected=a};this.getSettings=function(){var b={};b.item=a;b.componentOptions=this.component.getOptions();return b};this.clone=function(c){var d=GlobalEditor.ObjectUtil.clone(a),
c=b.clone(c);return new GlobalEditor.EditComponentItem(d,c)}};
GlobalEditor.ComponentManager={map:{},loadItems:[],gecp:{},loadComponent:function(a,b,c){this.isGecpFile(b)?this.loadComponentFromGecpFile(a,b,c):this.loadComponentFromFolder(a,b,c)},loadComponentFromFolder:function(a,b,c){$.getJSON("componentLib/"+a+"/"+b+"/config.json",function(e){function d(){$.getScript("componentLib/"+a+"/"+b+"/"+e.require[f],function(){f++;f==e.require.length?c(e):d(f)})}if(e.require.length==0)c(e);else{var f=0;d()}})},loadComponentFromGecpFile:function(a,b,c){var e=this;$.getJSON("componentLib/"+
a+"/"+b,function(a){var f={desc:a.component.desc,icon:a.component.icon,name:a.component.name};e.gecp[b]=f;a=a.component.js;try{eval(a),c(f)}catch(g){GlobalEditor.Alert.show(g)}})},isGecpFile:function(a){return a.split(".").indexOf("gecp")==1},append:function(a,b,c){this.loadItems.push({type:a,name:b,onComplete:c})},startLoad:function(a){function b(e){var d=c.loadItems[e];c.loadComponent(d.type,d.name,function(f){d.onComplete(f);e++;e<c.loadItems.length?b(e):a!=void 0&&a()})}var c=this;b(0)}};
GlobalEditor.DragItem=function(a,b){this.view=$("<div class='dragItem'></div>");this.img=$("<img>",{src:a,ondragstart:"return false;"});this.img.appendTo(this.view);b!=void 0&&(this.view.outerWidth(b.width),this.view.outerHeight(b.height),this.img.css("max-width",b.width-10),this.img.css("max-height",b.height-10));this.getSnapshot=function(){var a=$("<div class='dragItemSnapshot'></div>");this.img.clone().appendTo(a);return a};this.setTip=function(a){this.view.attr("data-content",a);this.view.attr("data-variation",
"mini");this.view.popup({position:"bottom center"})}};
GlobalEditor.LeftBasePanel=function(a){function b(){$.each(d.data,function(a){a="type"+a;$('<a class="item" data-value="'+a+'">'+this.type+"</a>").appendTo(d.classDropdown.find(".menu"));f[a]=$("<div>")});d.classDropdown.removeClass("disabled");d.classDropdown.dropdown({onChange:function(a){d.content.children().detach();f[a].appendTo(d.content)}});d.classDropdown.dropdown("set selected","type0")}function c(){$.each(d.data,function(a){for(var a="type"+a,b=0;b<this.list.length;b++)d.createItem(this.type,
this.list[b]).view.appendTo(f[a])});d.onItemsCreateComplete()}function e(a){g!=void 0&&g.view.removeClass("selected");g=a;a.view.addClass("selected")}var d=this;this.classDropdown=$('<div class="ui dropdown item disabled"><div class="text"></div><i class="dropdown icon"></i><div class="menu"></div>');this.content=$("<div>");var f={},g;$.getJSON(a.name+"/list.json",function(a){d.data=a;b();c()});this.createItem=function(b,c){var f=this.getImageUrlForItem(c),g=this.getItemOption(),f=a.name+"/"+b+"/"+
f,l=new GlobalEditor.DragItem(f,g);l.view.mousedown(function(){function a(b){b.preventDefault();g==void 0&&(g=l.getSnapshot(),g.appendTo("body"));var c=b.clientX-g.outerWidth()*0.5,d=b.clientY-g.outerHeight()*0.5;g.offset({left:c,top:d});c=GlobalEditor.editorContainer.container.offset().left;d=GlobalEditor.editorContainer.container.offset().top;b=new Cesium.Cartesian2(b.clientX-c,b.clientY-d);(b=i.camera.pickEllipsoid(b,k.globe.ellipsoid))?(d=Cesium.Cartographic.fromCartesian(b),c=Cesium.Math.toDegrees(d.longitude),
d=Cesium.Math.toDegrees(d.latitude),n={lat:d,lng:c},m.position=b,m.show=!0,m.label.text=c.toFixed(2)+","+d.toFixed(2),m.label.pixelOffset=new Cesium.Cartesian2(0,g.outerHeight()*0.5+12),g.css("opacity",0.5)):(m.show=!1,g.css("opacity",1),n=void 0)}function f(){g!=void 0&&g.remove();i.entities.remove(m);$(document).unbind("mousemove",a);$(document).unbind("mouseup",f);if(n!=void 0)d.onSnapshotDrop({type:b,item:l,itemInfo:c,gps:n})}e(l);$(document).bind("mousemove",a);$(document).bind("mouseup",f);
var g,i=GlobalEditor.editorContainer.viewer,k=i.scene,m=i.entities.add({label:{font:"24px sans-serif",style:Cesium.LabelStyle.FILL_AND_OUTLINE,fillColor:Cesium.Color.YELLOW,outlineColor:Cesium.Color.BLACK,outlineWidth:2},point:{color:Cesium.Color.WHITE,pixelSize:5,outlineWidth:2},show:!1}),n});this.onItemCreate(b,c,l);return l};this.getImageUrlForItem=function(a){return a};this.getItemOption=function(){};this.onItemCreate=function(){};this.onItemsCreateComplete=function(){};this.detach=function(){this.classDropdown.detach();
this.content.detach()};this.attach=function(a,b){this.classDropdown.appendTo(a);this.content.appendTo(b)};this.onSnapshotDrop=function(){}};
GlobalEditor.ComponentPanel=function(){GlobalEditor.LeftBasePanel.call(this,{name:"componentLib"});this.getImageUrlForItem=function(a){return GlobalEditor.ComponentManager.isGecpFile(a)?"../../assets/image/gecp.png":a+"/icon.png"};this.getItemOption=function(){return{width:50,height:50}};this.onItemCreate=function(a,b,c){c.view.css("pointer-events","none");c.view.css("opacity",0.5);GlobalEditor.ComponentManager.append(a,b,function(a){c.view.css("pointer-events","auto");c.view.css("opacity",1);c.setTip(a.desc);
GlobalEditor.ComponentManager.isGecpFile(b)&&c.img.attr("src",a.icon)})};this.onItemsCreateComplete=function(){GlobalEditor.ComponentManager.startLoad()};this.onSnapshotDrop=function(a){var b=GlobalEditor.ComponentManager.isGecpFile(a.itemInfo),c={icon:a.item.img.attr("src"),componentOptions:{gps:a.gps}};c.componentName=b?GlobalEditor.ComponentManager.gecp[a.itemInfo].name:a.itemInfo;GlobalEditor.GeneralManager.addComponent(c)}};
GlobalEditor.ImagePanel=function(){GlobalEditor.LeftBasePanel.call(this,{name:"imageLib"});this.getItemOption=function(){return{width:62,height:62}};this.onSnapshotDrop=function(a){a={componentName:"BillboardComponent",icon:a.item.img.attr("src"),componentOptions:{gps:a.gps,url:a.item.img.attr("src")}};GlobalEditor.GeneralManager.addComponent(a)}};
GlobalEditor.Model3dPanel=function(){GlobalEditor.LeftBasePanel.call(this,{name:"modelLib"});this.getImageUrlForItem=function(a){return a.name+"/icon.png"};this.getItemOption=function(){return{width:78,height:78}};this.onSnapshotDrop=function(a){a={componentName:"ModelComponent",icon:a.item.img.attr("src"),componentOptions:{gps:a.gps,url:"modelLib/"+a.type+"/"+a.itemInfo.name+"/"+a.itemInfo.model}};GlobalEditor.GeneralManager.addComponent(a)}};
GlobalEditor.ComponentContainer=function(){var a=$('<div class="right menu"><a class="item"><i class="remove circle icon"></i></a></div>'),b=a.find("a").eq(0);this.content=$("<div>");var c=[],e=null;b.click(function(){e!=null?GlobalEditor.GeneralManager.removeComponent(e):GlobalEditor.Alert.show("\u6ca1\u6709\u9009\u4e2d\u7684\u7ec4\u4ef6,\u65e0\u6cd5\u5220\u9664!")});var d=GlobalEditor.editorContainer.viewer,f=d.screenSpaceEventHandler.getInputAction(Cesium.ScreenSpaceEventType.LEFT_CLICK);d.screenSpaceEventHandler.setInputAction(function(a){f(a);
if(d.selectedEntity==void 0)GlobalEditor.GeneralManager.selectComponent(null);else{for(var b,a=0;a<c.length;a++){var e=c[a];if(d.selectedEntity==e.component.entity){b=e;break}}b!=void 0?GlobalEditor.GeneralManager.selectComponent(b):GlobalEditor.GeneralManager.selectComponent(null)}},Cesium.ScreenSpaceEventType.LEFT_CLICK);d.infoBox.viewModel.closeClicked.addEventListener(function(){GlobalEditor.GeneralManager.selectComponent(null)});this.detach=function(){a.detach();this.content.detach()};this.attach=
function(b,c){a.appendTo(b);this.content.appendTo(c)};this.addItem=function(a){a.view.appendTo(this.content);a.initEvents();a.component.play();c.push(a)};this.addItemAt=function(a,b){b<=c.length-1?(a.view.insertBefore(c[b].view),a.initEvents(),a.component.play(),c.splice(b,0,a)):this.addItem(a)};this.removeItem=function(a){var b=c.indexOf(a);c.splice(b,1);a.view.remove();a.component.stop()};this.getSelectedItem=function(){return e};this.getItems=function(){return c};this.selectItem=function(a){if(e!=
null)e.setSelected(!1),d.selectedEntity=void 0;e=a;if(e!=null)e.setSelected(!0),d.selectedEntity=e.component.entity};this.getSettings=function(){var a=[];$.each(c,function(){a.push(this.getSettings())});return a};this.setSettings=function(a){var b=this;$.each(a,function(){var a=new GlobalEditor.ComponentManager.map[this.item.name](this.componentOptions),a=new GlobalEditor.EditComponentItem(this.item,a);b.addItem(a)})};this.clear=function(){for(;c.length>0;)this.removeItem(c[0]);this.selectItem(null);
GlobalEditor.propertiesPanel.update()}};
GlobalEditor.LeftPanel=function(a){var a=$(a),b=a.find(".ui.menu"),c=b.find(".ui.dropdown").eq(0),e=a.find("#container"),d,f={component:new GlobalEditor.ComponentPanel,image:new GlobalEditor.ImagePanel,model3d:new GlobalEditor.Model3dPanel,componentContainer:new GlobalEditor.ComponentContainer};c.dropdown({onChange:function(a){d!=void 0&&d.detach();d=f[a];d.attach(b,e)}});this.selectGroup=function(a){c.dropdown("set selected",a)};this.selectGroup("component");this.getComponentContainer=function(){return f.componentContainer}};
GlobalEditor.ComponentManager.map.EntityComponent=function(a){GlobalEditor.ComponentBase.call(this);var b=GlobalEditor.editorContainer.viewer;this.play=function(){this.entity=b.entities.add(this.getEntityOptions());this.descriptor=new GlobalEditor.EntityDescriptor(this.entity);if(this.title!=void 0)this.descriptor.title=this.title;a.settings!=void 0&&this.descriptor.dataModel.setSettings(a.settings)};this.stop=function(){b.entities.remove(this.entity)};this.getEntityOptions=function(){return{}};this.getOptions=
function(){a.settings=this.descriptor.dataModel.getSettings();return a};this.cloneOptionsHandle=function(a){a.settings.position=void 0;return a}};GlobalEditor.ComponentBaseDescriptor=function(){this.title="\u57fa\u672c\u7ec4\u4ef6";this.dataModel=new GlobalEditor.DescriptorDataModel(this);GlobalEditor.BasicDescriptor.call(this,this.dataModel)};GlobalEditor.FormViewManager={};GlobalEditor.FormViewManager.createPositionView=function(){return $('<div class="inline fields">\t<div class="eight wide field">\t\t<label>X</label>\t\t<input type="text" placeholder="">   </div>   <div class="eight wide field">\t\t<label>Y</label>\t\t<input type="text" placeholder="">\t</div></div>')};
GlobalEditor.FormViewManager.createSizeView=function(){return $('<div class="inline fields">\t<div class="eight wide field">\t\t<label>\u5bbd</label>\t\t<input type="text" placeholder="">   </div>   <div class="eight wide field">\t\t<label>\u9ad8</label>\t\t<input type="text" placeholder="">\t</div></div>')};GlobalEditor.FormViewManager.createHline=function(){return $('<div class="ui divider"></div>')};
GlobalEditor.FormViewManager.createCheckBoxView=function(a){return $('<div class="inline fields">\t<div class="five wide field">\t\t<label>'+a+'</label>\t</div>\t<div class="eleven wide field">\t\t<div class="ui checkbox">\t\t\t<input type="checkbox">\t\t\t<label></label>\t\t</div>\t</div></div>')};
GlobalEditor.FormViewManager.createDropdownView=function(a,b){for(var c=$('<div class="inline fields">\t<div class="five wide field">\t\t<label>'+a+'</label>\t</div>\t<div class="eleven wide field">\t\t<div class="ui selection dropdown">\t\t\t<i class="dropdown icon"></i>\t\t\t<div class="default text"></div>\t\t\t<div class="menu">\t\t\t</div>\t\t</div>\t</div></div>'),e=c.find(".menu"),d=b.length,f=0;f<d;f++)$('<div class="item" data-value="'+b[f].value+'">'+b[f].label+"</div>").appendTo(e);return c};
GlobalEditor.FormViewManager.createHeader=function(a){var b=$("<div>",{style:"padding:3px;background-color:#e9e9e9;margin-bottom:10px;font-size:11px;"});b.text(a);return b};GlobalEditor.FormViewManager.createColorPickerView=function(a){return $('<div class="inline fields">\t<div class="five wide field">\t\t<label>'+a+'</label>\t</div>\t<div class="eleven wide field">\t\t<div class="colorPicker">\t\t\t<div class="box"></div>\t\t</div>\t</div></div>')};
GlobalEditor.FormViewManager.createTextInputView=function(a){return $('<div class="inline fields">\t<div class="five wide field">\t\t<label>'+a+'</label>\t</div>\t<div class="eleven wide field">\t\t<input type="text" placeholder="">\t</div></div>')};
GlobalEditor.FormViewManager.createTextInputWithRightLabelView=function(a,b){return $('<div class="inline fields">\t<div class="five wide field">\t\t<label>'+a+'</label>\t</div>\t<div class="eleven wide field">\t\t<div class="ui right labeled input">\t\t\t<input type="text" placeholder="">\t\t\t<div class="ui basic label">'+b+"</div>\t\t</div>\t</div></div>")};GlobalEditor.FormViewManager.createTextAreaView=function(a){return $('<div class="field">\t<label>'+a+'</label>\t<textarea style="margin-top: 0px; margin-bottom: 0px; height: 148px;"></textarea></div>')};
GlobalEditor.FormViewManager.createSliderView=function(a){return $('<div class="inline fields">\t<div class="five wide field">\t\t<label>'+a+'</label>\t</div>\t<div class="eight wide field">\t\t<div class="ui slider" style="width:95%"></div>\t</div>\t<div class="four wide field">\t\t<input type="text" placeholder="">\t</div></div>')};
GlobalEditor.FormViewManager.createIconButtonGroupView=function(a,b){for(var c=$('<div class="inline fields">\t<div class="five wide field">\t\t<label>'+a+'</label>\t</div>\t<div class="eleven wide field">\t\t<div class="ui icon basic buttons"></div>\t</div></div>'),e=c.find(".buttons"),d=0;d<b.length;d++)$('<button class="ui button" data-value="'+b[d].value+'"><i class="'+b[d].icon+' icon"></i></button>').appendTo(e);return c};
GlobalEditor.FormViewManager.createButtonGroupView=function(a,b){for(var c=$('<div class="inline fields">\t<div class="five wide field">\t\t<label>'+a+'</label>\t</div>\t<div class="eleven wide field">\t\t<div class="ui icon basic buttons"></div>\t</div></div>'),e=c.find(".buttons"),d=0;d<b.length;d++)$('<button class="ui button" data-value="'+b[d].value+'">'+b[d].label+"</button>").appendTo(e);return c};
GlobalEditor.FormViewManager.createCesiumCartesian3View=function(a){return $('<div class="inline fields">\t<label style="position:absolute;margin-top:7px;">'+a+'</label>\t<div class="five wide field"></div>\t<div class="eleven wide">\t\t<div class="inline fields"><label>x</label><input type="text"></div>\t\t<div class="inline fields"><label>y</label><input type="text"></div>\t\t<div class="inline fields" style="margin-bottom:0;"><label>z</label><input type="text"></div>\t</div></div>')};
GlobalEditor.FormViewManager.createCesiumCartesian2View=function(a){return $('<div class="inline fields">\t<label style="position:absolute;margin-top:7px;">'+a+'</label>\t<div class="five wide field"></div>\t<div class="eleven wide">\t\t<div class="inline fields"><label>x</label><input type="text"></div>\t\t<div class="inline fields" style="margin-bottom:0;"><label>y</label><input type="text"></div>\t</div></div>')};
GlobalEditor.FormViewManager.createCesiumOrientationView=function(a){return $('<div class="inline fields">\t<label style="position:absolute;margin-top:7px;">'+a+'</label>\t<div class="five wide field"></div>\t<div class="eleven wide">\t\t<div class="inline fields"><label>heading</label><div class="ui slider" style="margin-left:10px;margin-right:10px;width:100px"></div><input type="text" style="max-width:50px;"></div>\t\t<div class="inline fields"><label>pitch</label><div class="ui slider" style="margin-left:10px;margin-right:10px;width:100px"></div><input type="text" style="max-width:50px;"></div>\t\t<div class="inline fields" style="margin-bottom:0;"><label>roll</label><div class="ui slider" style="margin-left:10px;margin-right:10px;width:100px"></div><input type="text" style="max-width:50px;"></div>\t</div></div>')};
GlobalEditor.FormViewManager.createIconView=function(a,b){var c=$('<div class="inline fields">\t<label style="position:absolute;margin-top:0px;">'+a+'</label>\t<div class="five wide field"></div>\t<div class="eleven wide"></div></div>'),e=c.find(".eleven.wide").eq(0),d=$('<div class="iconPicker">');d.innerWidth(b.width);d.innerHeight(b.height);d.appendTo(e);e=$("<canvas>");e.get(0).width=b.width;e.get(0).height=b.height;e.appendTo(d);return c};
GlobalEditor.FormViewManager.createCesiumMaterialView=function(a){return $('<div class="inline fields">\t<div class="five wide field">\t\t<label>'+a+'</label>\t</div>\t<div class="eleven wide field">\t\t<button class="ui button">\u7f16\u8f91\u6750\u8d28</button>\t</div></div>')};
GlobalEditor.BasicDescriptor=function(a){this.dataModels=[];this.init=function(b){b.header.text(this.title);this.container=b.form;this.addDataModel(a)};this.update=function(){this.container!=void 0&&$.each(this.dataModels,function(){this.update()})};this.addDataModel=function(a){a.createTo(this.container);this.dataModels.push(a)}};
GlobalEditor.ViewerDescriptor=function(){this.title="\u89c6\u56fe";var a=new GlobalEditor.DescriptorDataModel(this);a.add({type:"slider",label:"\u89e3\u6790\u5ea6",name:"resolutionScale",min:0.01,max:1});a.add({type:"checkBox",label:"\u9634\u5f71",name:"shadows"});a.add({type:"checkBox",label:"\u5730\u5f62\u9634\u5f71",name:"terrainShadows"});a.add({type:"header",label:"\u573a\u666f"});a.add({type:"checkBox",label:"\u5149\u7167",name:"enableLighting"});a.add({type:"checkBox",label:"\u96fe",name:"enableFog"});
a.add({type:"checkBox",label:"\u6297\u5267\u9f7f",name:"fxaa"});a.add({type:"header",label:"\u5929\u7a7a\u76d2"});a.add({type:"checkBox",label:"\u663e\u793a",name:"showSkyBox"});a.add({type:"header",label:"\u5927\u6c14\u5c42"});var b=GlobalEditor.editorContainer.viewer,c=new GlobalEditor.SkyAtmosphereDataModel(new GlobalEditor.SkyAtmosphereDelegate(b.scene.skyAtmosphere));c.name="skyAtmosphere";a.add(c);GlobalEditor.BasicDescriptor.call(this,a);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,
b,"resolutionScale");GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,b,"shadows");GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,b,"terrainShadows");GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,b.scene,"fxaa");GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,b.scene.globe,"enableLighting");this.getEnableFog=function(){return GlobalEditor.editorContainer.viewer.scene.fog.enabled};this.setEnableFog=function(a){GlobalEditor.editorContainer.viewer.scene.fog.enabled=
a};this.getShowSkyBox=function(){return GlobalEditor.editorContainer.viewer.scene.skyBox.show};this.setShowSkyBox=function(a){GlobalEditor.editorContainer.viewer.scene.skyBox.show=a};this.getSettings=function(){return a.getSettings()};this.setSettings=function(b){a.setSettings(b)};this.clear=function(){a.setSettings(this.defaultSettings)};this.defaultSettings=this.getSettings()};
GlobalEditor.TerrainDescriptor=function(a){var b=new GlobalEditor.DescriptorDataModel(this);b.add({type:"checkBox",label:"\u9ed8\u8ba4",name:"defaultTerrain"});b.add({type:"dropdown",label:"\u63d0\u4f9b\u8005",name:"terrainProvider",data:[{value:0,label:"Cesium"},{value:1,label:"ArcGisImageServer"},{value:2,label:"VRTheWorld"}]});b.add({type:"input",label:"\u5730\u5740",name:"url"});b.add({type:"checkBox",label:"\u9876\u70b9\u6cd5\u7ebf",name:"requestVertexNormals"});b.add({type:"checkBox",label:"\u6c34\u9762",
name:"requestWaterMask"});b.add({type:"input",label:"\u5730\u5740",name:"url1"});b.add({type:"input",label:"token",name:"token"});b.add({type:"input",label:"\u5730\u5740",name:"url2"});GlobalEditor.BasicDescriptor.call(this,b);var c=this,e=this.init;this.init=function(a){e.call(this,a);this.checkEnable();this.checkType()};this.checkEnable=function(){var a=this.container.children(),a=a.splice(1,a.length),b=this.getDefaultTerrain();$.each(a,function(){$(this)[b?"addClass":"removeClass"]("disabled")})};
this.checkType=function(){var a=this.container.children(),a=a.splice(2,a.length),b=this.getTerrainProvider();$(a).hide();[$(a).eq(0).add(a[1]).add(a[2]),$(a).eq(3).add(a[4]),$(a).eq(5)][b].show()};this.getDefaultTerrain=function(){return a.useDefault};this.setDefaultTerrain=function(b){a.useDefault=b;a.update();c.checkEnable()};this.getTerrainProvider=function(){return a.typeIdx};this.setTerrainProvider=function(b){a.typeIdx=b;a.update();c.checkType()};this.getUrl=function(){return a.providerSettings[0].url};
this.setUrl=function(b){a.providerSettings[0].url=b;a.update()};this.getRequestVertexNormals=function(){return a.providerSettings[0].requestVertexNormals};this.setRequestVertexNormals=function(b){a.providerSettings[0].requestVertexNormals=b;a.update()};this.getRequestWaterMask=function(){return a.providerSettings[0].requestWaterMask};this.setRequestWaterMask=function(b){a.providerSettings[0].requestWaterMask=b;a.update()};this.getUrl1=function(){return a.providerSettings[1].url};this.setUrl1=function(b){a.providerSettings[1].url=
b;a.update()};this.getToken=function(){return a.providerSettings[1].token};this.setToken=function(b){a.providerSettings[1].token=b;a.update()};this.getUrl2=function(){return a.providerSettings[2].url};this.setUrl2=function(b){a.providerSettings[2].url=b;a.update()};this.getSettings=function(){var a={};a.defaultTerrain=this.getDefaultTerrain();if(!a.defaultTerrain)a.terrainProvider=this.getTerrainProvider(),[function(){a.url=c.getUrl();a.requestVertexNormals=c.getRequestVertexNormals();a.requestWaterMask=
c.getRequestWaterMask()},function(){a.url=c.getUrl1();a.token=c.getToken()},function(){a.url=c.getUrl2()}][a.terrainProvider]();return a};this.setSettings=function(a){this.setDefaultTerrain(a.defaultTerrain);a.defaultTerrain||(this.setTerrainProvider(a.terrainProvider),[function(){c.setUrl(a.url);c.setRequestVertexNormals(a.requestVertexNormals);c.setRequestWaterMask(a.requestWaterMask)},function(){c.setUrl1(a.url);c.setToken(a.token)},function(){c.setUrl2(a.url)}][a.terrainProvider]())};this.clear=
function(){this.setDefaultTerrain(!0)}};
GlobalEditor.ImageLayerAdjustDescriptor=function(a){var b=new GlobalEditor.DescriptorDataModel(this);b.add({type:"checkBox",label:"\u663e\u793a",name:"show"});b.add({type:"slider",label:"\u900f\u660e\u5ea6",name:"alpha",min:0,max:1});b.add({type:"slider",label:"\u4eae\u5ea6",name:"brightness",min:0,max:3});b.add({type:"slider",label:"\u5bf9\u6bd4\u5ea6",name:"contrast",min:0,max:3});b.add({type:"slider",label:"\u8272\u8c03",name:"hue",min:0,max:3});b.add({type:"slider",label:"\u9971\u548c\u5ea6",
name:"saturation",min:0,max:3});b.add({type:"slider",label:"gamma",name:"gamma",min:0,max:3});GlobalEditor.BasicDescriptor.call(this,b);var c=this;$.each(["show","alpha","brightness","contrast","hue","saturation","gamma"],function(){GlobalEditor.DescriptorDataModel.createGetterAndSetter(c,a.settings,this,void 0,void 0,void 0,function(){a.update()})})};
GlobalEditor.EntityDescriptor=function(a){this.title="Entity";this.delegate=new GlobalEditor.EntityDelegate(a);this.dataModel=new GlobalEditor.EntityDataModel(this.delegate);GlobalEditor.BasicDescriptor.call(this,this.dataModel)};GlobalEditor.DescriptorDataModel=function(a){var b=this;this.delegate=a;this.items=[];this.itemControllers=[];this.add=function(a){this.items.push(a)};this.remove=function(a){a=this.items.indexOf(a);a>-1&&this.items.splice(a,1)};this.createTo=function(a){function e(d){if(d!=b.items.length){var f=b.items[d];b.isDataModel(f)?(f.createTo(a),b.itemControllers.push(f.itemControllers)):(f=GlobalEditor.DescItemMap.create(f,b,a),b.itemControllers.push(f));d++;e(d)}}this.items.length!=0&&e(0)};this.getAndSetFuncForName=
function(a){a=GlobalEditor.DescriptorDataModel.getFuncName(a);return[this.delegate[a.getStr],this.delegate[a.setStr]]};this.update=function(){function a(b){for(var d=0;d<b.length;d++){var f=b[d];f instanceof Array?a(f):f.update!=void 0&&f.update()}}a(this.itemControllers)};this.isDataModel=function(a){return a.type==void 0&&a.createTo!=void 0};this.getSettings=function(){function a(d){if(d!=b.items.length){var f=b.items[d];if(b.isDataModel(f))e[f.name]=f.getSettings();else if(f.name!=void 0){var g=
b.getAndSetFuncForName(f.name)[0];e[f.name]=g()}d++;a(d)}}var e={};a(0);return e=this.encodeSettings(e)};this.setSettings=function(a){a=this.decodeSettings(a);for(key in a){var b=this.getAndSetFuncForName(key)[1];b!=void 0?a[key]!=void 0&&b(a[key]):(b=this.getSubDataModelByName(key),b!=void 0&&b.setSettings(a[key]))}};this.encodeSettings=function(a){var b={};for(key in a){var d=a[key];if(typeof d=="object")if(this.getAndSetFuncForName(key)[1]!=void 0)b[key]=GlobalEditor.DescriptorDataModel.Encoder.encode(d);
else{var f=this.getSubDataModelByName(key);f!=void 0&&(b[key]=f.encodeSettings(d))}else b[key]=d}return b};this.decodeSettings=function(a){var b={};for(key in a){var d=a[key];if(typeof d=="object")if(this.getAndSetFuncForName(key)[1]!=void 0)b[key]=GlobalEditor.DescriptorDataModel.Encoder.decode(d);else{var f=this.getSubDataModelByName(key);f!=void 0&&(b[key]=f.decodeSettings(d))}else b[key]=d}return b};this.getSubDataModelByName=function(a){for(var b=this.items.length,d=0;d<b;d++){var f=this.items[d];
if(this.isDataModel(f)&&f.name==a)return f}}};
GlobalEditor.DescriptorDataModel.Encoder={encode:function(a){return a instanceof Cesium.Cartesian3?{x:a.x,y:a.y,z:a.z,className:"Cartesian3"}:a instanceof Cesium.Cartesian2?{x:a.x,y:a.y,className:"Cartesian2"}:a instanceof Cesium.Cartographic?{lng:a.longitude,lat:a.latitude,height:a.height,className:"Cartographic"}:GlobalEditor.editMaterialWin.isMaterialProperty(a)?GlobalEditor.editMaterialWin.encode(a):a},decode:function(a){return a.className=="Cartesian3"?new Cesium.Cartesian3(a.x,a.y,a.z):a.className==
"Cartesian2"?new Cesium.Cartesian2(a.x,a.y):a.className=="Cartographic"?new Cesium.Cartographic(a.lng,a.lat,a.height):GlobalEditor.editMaterialWin.getClassNames().indexOf(a.className)>-1?GlobalEditor.editMaterialWin.decode(a):a}};GlobalEditor.DescriptorDataModel.getFuncName=function(a){var b=a.length,a=a.charAt(0).toUpperCase()+a.substr(1,b-1);return{getStr:"get"+a,setStr:"set"+a}};
GlobalEditor.DescriptorDataModelHandle={donothing:function(a){return a},emptyToUndefined:function(a){return a!=""?a:void 0},cesiumProperty:function(a){return GlobalEditor.CesiumUtil.getPropertyValue(a)},cesiumColorProperty:function(a){return GlobalEditor.CesiumUtil.getPropertyValue(a).toCssColorString()},numberValue:function(a){return Number(a)},cesiumColorValue:function(a){return Cesium.Color.fromCssColorString(a)},cesiumPositionsString:function(a){var a=GlobalEditor.CesiumUtil.getPropertyValue(a),
b=[];$.each(a,function(){var a=Cesium.Cartographic.fromCartesian(this);b.push({lng:Cesium.Math.toDegrees(a.longitude),lat:Cesium.Math.toDegrees(a.latitude),height:a.height})});return JSON.stringify(b)},cesiumPositionsValue:function(a){var b=[],a=JSON.parse(a);$.each(a,function(){var a=Cesium.Cartesian3.fromDegrees(this.lng,this.lat,this.height);b.push(a)});return b},cesiumNearFarScalarString:function(a){a=GlobalEditor.CesiumUtil.getPropertyValue(a);a!=""&&(a=[a.near,a.nearValue,a.far,a.farValue].join(","));
return a},cesiumNearFarScalarValue:function(a){var b,a=a.split(",");a.length==4&&(b=new Cesium.NearFarScalar(Number(a[0]),Number(a[1]),Number(a[2]),Number(a[3])));return b},cesiumCartesian2ArrayString:function(a){var a=GlobalEditor.CesiumUtil.getPropertyValue(a),b=[];$.each(a,function(){b.push({x:this.x,y:this.y})});return JSON.stringify(b)},cesiumCartesian2ArrayValue:function(a){var b=[],a=JSON.parse(a);$.each(a,function(){var a=new Cesium.Cartesian2(this.x,this.y);b.push(a)});return b},cesiumRectangleString:function(a){a=
GlobalEditor.CesiumUtil.getPropertyValue(a);return JSON.stringify({west:Cesium.Math.toDegrees(a.west),south:Cesium.Math.toDegrees(a.south),east:Cesium.Math.toDegrees(a.east),north:Cesium.Math.toDegrees(a.north)})},cesiumRectangleValue:function(a){a=JSON.parse(a);return Cesium.Rectangle.fromDegrees(a.west,a.south,a.east,a.north)},cesiumDegress:function(a){return Cesium.Math.toDegrees(GlobalEditor.CesiumUtil.getPropertyValue(a))},cesiumRadiansValue:function(a){return Cesium.Math.toRadians(Number(a))},
cesiumArrayString:function(a){return GlobalEditor.CesiumUtil.getPropertyValue(a).join(",")},cesiumArrayValue:function(a){return a.split(",")}};GlobalEditor.DescriptorDataModel.createGetterAndSetter=function(a,b,c,e,d,f,g){var h=this.getFuncName(c);a[h.getStr]=function(){f!=void 0&&(b[c]=Cesium.defaultValue(b[c],f));return(e==void 0?GlobalEditor.DescriptorDataModelHandle.donothing:e)(b[c])};a[h.setStr]=function(a){b[c]=(d==void 0?GlobalEditor.DescriptorDataModelHandle.donothing:d)(a);g!=void 0&&g()}};
GlobalEditor.BillboardDataModel=function(a){GlobalEditor.DescriptorDataModel.call(this,a);this.add({type:"input",label:"\u56fe\u7247",name:"image"});this.add({type:"checkBox",label:"\u663e\u793a",name:"show"});this.add({type:"slider",label:"\u7f29\u653e",name:"scale",min:0,max:10});this.add({type:"dropdown",label:"\u6c34\u5e73\u951a\u70b9",name:"horizontalOrigin",data:[{label:"\u5de6",value:Cesium.HorizontalOrigin.LEFT},{label:"\u4e2d",value:Cesium.HorizontalOrigin.CENTER},{label:"\u53f3",value:Cesium.HorizontalOrigin.RIGHT}]});
this.add({type:"dropdown",label:"\u5782\u76f4\u951a\u70b9",name:"verticalOrigin",data:[{label:"\u4e0a",value:Cesium.VerticalOrigin.TOP},{label:"\u4e2d",value:Cesium.VerticalOrigin.CENTER},{label:"\u4e0b",value:Cesium.VerticalOrigin.BOTTOM}]});this.add({type:"hline"});this.add({type:"cesiumCartesian3",label:"eyeOffset",name:"eyeOffset"});this.add({type:"cesiumCartesian2",label:"pixelOffset",name:"pixelOffset"});this.add({type:"slider",label:"\u65cb\u8f6c",name:"rotation",min:-360,max:360});this.add({type:"cesiumCartesian3",
label:"alignedAxis",name:"alignedAxis"});this.add({type:"size",name:"size"});this.add({type:"color",label:"\u989c\u8272",name:"color"});this.add({type:"input",label:"scale By Distance",name:"scaleByDistance"});this.add({type:"input",label:"translucency By Distance",name:"translucencyByDistance"});this.add({type:"input",label:"pixelOffset Scale By Distance",name:"pixelOffsetScaleByDistance"});this.add({type:"checkBox",label:"sizeInMeters",name:"sizeInMeters"})};
GlobalEditor.BillboardDelegate=function(a){GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"image",GlobalEditor.DescriptorDataModelHandle.cesiumProperty);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"show",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,void 0,!0);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"scale",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,GlobalEditor.DescriptorDataModelHandle.numberValue,1);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,
a,"horizontalOrigin",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,GlobalEditor.DescriptorDataModelHandle.numberValue,Cesium.HorizontalOrigin.CENTER);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"verticalOrigin",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,GlobalEditor.DescriptorDataModelHandle.numberValue,Cesium.VerticalOrigin.CENTER);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"eyeOffset",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,void 0,
Cesium.Cartesian3.ZERO);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"pixelOffset",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,void 0,Cesium.Cartesian2.ZERO);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"rotation",GlobalEditor.DescriptorDataModelHandle.cesiumDegress,GlobalEditor.DescriptorDataModelHandle.cesiumRadiansValue,0);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"alignedAxis",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,
void 0,Cesium.Cartesian3.ZERO);this.getSize=function(){return{width:GlobalEditor.CesiumUtil.getPropertyValue(a.width),height:GlobalEditor.CesiumUtil.getPropertyValue(a.height)}};this.setSize=function(b){a.width=b.width!=""?Number(b.width):void 0;a.height=b.height!=""?Number(b.height):void 0};GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"color",GlobalEditor.DescriptorDataModelHandle.cesiumColorProperty,GlobalEditor.DescriptorDataModelHandle.cesiumColorValue,Cesium.Color.WHITE);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,
a,"scaleByDistance",GlobalEditor.DescriptorDataModelHandle.cesiumNearFarScalarString,GlobalEditor.DescriptorDataModelHandle.cesiumNearFarScalarValue);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"translucencyByDistance",GlobalEditor.DescriptorDataModelHandle.cesiumNearFarScalarString,GlobalEditor.DescriptorDataModelHandle.cesiumNearFarScalarValue);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"pixelOffsetScaleByDistance",GlobalEditor.DescriptorDataModelHandle.cesiumNearFarScalarString,
GlobalEditor.DescriptorDataModelHandle.cesiumNearFarScalarValue);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"sizeInMeters",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,void 0,!1)};
GlobalEditor.BoxDataModel=function(a){GlobalEditor.DescriptorDataModel.call(this,a);this.add({type:"cesiumCartesian3",label:"dimensions",name:"dimensions"});this.add({type:"checkBox",label:"\u663e\u793a",name:"show"});this.add({type:"checkBox",label:"\u586b\u5145",name:"fill"});this.add({type:"cesiumMaterial",name:"material",label:"\u6750\u8d28"});this.add({type:"checkBox",name:"outline",label:"outline"});this.add({type:"color",name:"outlineColor",label:"outlineColor"});this.add({type:"input",name:"outlineWidth",
label:"outlineWidth"})};
GlobalEditor.BoxDelegate=function(a){GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"dimensions",GlobalEditor.DescriptorDataModelHandle.cesiumProperty);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"show",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,void 0,!0);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"fill",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,void 0,!0);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"material");
GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"outline",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,void 0,!1);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"outlineColor",GlobalEditor.DescriptorDataModelHandle.cesiumColorProperty,GlobalEditor.DescriptorDataModelHandle.cesiumColorValue,Cesium.Color.BLACK);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"outlineWidth",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,GlobalEditor.DescriptorDataModelHandle.numberValue,
1)};
GlobalEditor.CorridorDataModel=function(a){GlobalEditor.DescriptorDataModel.call(this,a);this.add({type:"textArea",name:"positions",label:"positions"});this.add({type:"input",name:"width",label:"\u5bbd"});this.add({type:"dropdown",name:"cornerType",label:"cornerType",data:[{label:"ROUNDED",value:Cesium.CornerType.ROUNDED},{label:"BEVELED",value:Cesium.CornerType.BEVELED},{label:"MITERED",value:Cesium.CornerType.MITERED}]});this.add({type:"input",name:"height",label:"\u9ad8"});this.add({type:"input",name:"extrudedHeight",
label:"extruded height"});this.add({type:"checkBox",name:"show",label:"\u663e\u793a"});this.add({type:"checkBox",name:"fill",label:"\u586b\u5145"});this.add({type:"cesiumMaterial",name:"material",label:"\u6750\u8d28"});this.add({type:"checkBox",name:"outline",label:"outline"});this.add({type:"color",name:"outlineColor",label:"outlineColor"});this.add({type:"input",name:"outlineWidth",label:"outlineWidth"});this.add({type:"input",name:"granularity",label:"granularity"})};
GlobalEditor.CorridorDelegate=function(a){GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"positions",GlobalEditor.DescriptorDataModelHandle.cesiumPositionsString,GlobalEditor.DescriptorDataModelHandle.cesiumPositionsValue);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"width",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,GlobalEditor.DescriptorDataModelHandle.numberValue);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"cornerType",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,
void 0,Cesium.CornerType.ROUNDED);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"height",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,GlobalEditor.DescriptorDataModelHandle.numberValue,0);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"extrudedHeight",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,GlobalEditor.DescriptorDataModelHandle.numberValue);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"show",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,
void 0,!0);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"fill",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,void 0,!0);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"material");GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"outline",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,void 0,!1);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"outlineColor",GlobalEditor.DescriptorDataModelHandle.cesiumColorProperty,GlobalEditor.DescriptorDataModelHandle.cesiumColorValue,
Cesium.Color.BLACK);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"outlineWidth",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,GlobalEditor.DescriptorDataModelHandle.numberValue,1);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"granularity",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,GlobalEditor.DescriptorDataModelHandle.numberValue,Cesium.Math.RADIANS_PER_DEGREE)};
GlobalEditor.CylinderDataModel=function(a){GlobalEditor.DescriptorDataModel.call(this,a);this.add({type:"input",name:"length",label:"length"});this.add({type:"input",name:"topRadius",label:"topRadius"});this.add({type:"input",name:"bottomRadius",label:"bottomRadius"});this.add({type:"checkBox",label:"\u663e\u793a",name:"show"});this.add({type:"checkBox",label:"\u586b\u5145",name:"fill"});this.add({type:"cesiumMaterial",name:"material",label:"\u6750\u8d28"});this.add({type:"checkBox",name:"outline",
label:"outline"});this.add({type:"color",name:"outlineColor",label:"outlineColor"});this.add({type:"input",name:"outlineWidth",label:"outlineWidth"});this.add({type:"input",name:"numberOfVerticalLines",label:"number Of VerticalLines"});this.add({type:"input",name:"slices",label:"slices"})};
GlobalEditor.CylinderDelegate=function(a){GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"length",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,GlobalEditor.DescriptorDataModelHandle.numberValue);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"topRadius",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,GlobalEditor.DescriptorDataModelHandle.numberValue);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"bottomRadius",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,
GlobalEditor.DescriptorDataModelHandle.numberValue);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"show",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,void 0,!0);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"fill",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,void 0,!0);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"material");GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"outline",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,
void 0,!1);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"outlineColor",GlobalEditor.DescriptorDataModelHandle.cesiumColorProperty,GlobalEditor.DescriptorDataModelHandle.cesiumColorValue,Cesium.Color.BLACK);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"outlineWidth",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,GlobalEditor.DescriptorDataModelHandle.numberValue,1);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"numberOfVerticalLines",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,
GlobalEditor.DescriptorDataModelHandle.numberValue,16);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"slices",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,GlobalEditor.DescriptorDataModelHandle.numberValue,128)};
GlobalEditor.EllipseDataModel=function(a){GlobalEditor.DescriptorDataModel.call(this,a);this.add({type:"input",name:"semiMajorAxis",label:"semiMajor Axis"});this.add({type:"input",name:"semiMinorAxis",label:"semiMinor Axis"});this.add({type:"input",name:"height",label:"height"});this.add({type:"input",name:"extrudedHeight",label:"extruded Height"});this.add({type:"checkBox",label:"\u663e\u793a",name:"show"});this.add({type:"checkBox",label:"\u586b\u5145",name:"fill"});this.add({type:"cesiumMaterial",
name:"material",label:"\u6750\u8d28"});this.add({type:"checkBox",name:"outline",label:"outline"});this.add({type:"color",name:"outlineColor",label:"outlineColor"});this.add({type:"input",name:"outlineWidth",label:"outlineWidth"});this.add({type:"input",name:"numberOfVerticalLines",label:"number Of VerticalLines"});this.add({type:"slider",label:"\u65cb\u8f6c",name:"rotation",min:-360,max:360});this.add({type:"slider",label:"stRotation",name:"stRotation",min:-360,max:360});this.add({type:"input",name:"granularity",
label:"granularity"})};
GlobalEditor.EllipseDelegate=function(a){GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"semiMajorAxis",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,GlobalEditor.DescriptorDataModelHandle.numberValue);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"semiMinorAxis",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,GlobalEditor.DescriptorDataModelHandle.numberValue);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"height",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,
GlobalEditor.DescriptorDataModelHandle.numberValue,0);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"extrudedHeight",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,GlobalEditor.DescriptorDataModelHandle.numberValue);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"show",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,void 0,!0);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"fill",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,void 0,
!0);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"material");GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"outline",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,void 0,!1);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"outlineColor",GlobalEditor.DescriptorDataModelHandle.cesiumColorProperty,GlobalEditor.DescriptorDataModelHandle.cesiumColorValue,Cesium.Color.BLACK);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"outlineWidth",
GlobalEditor.DescriptorDataModelHandle.cesiumProperty,GlobalEditor.DescriptorDataModelHandle.numberValue,1);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"numberOfVerticalLines",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,GlobalEditor.DescriptorDataModelHandle.numberValue,16);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"rotation",GlobalEditor.DescriptorDataModelHandle.cesiumDegress,GlobalEditor.DescriptorDataModelHandle.cesiumRadiansValue,0);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,
a,"stRotation",GlobalEditor.DescriptorDataModelHandle.cesiumDegress,GlobalEditor.DescriptorDataModelHandle.cesiumRadiansValue,0);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"granularity",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,GlobalEditor.DescriptorDataModelHandle.numberValue,Cesium.Math.RADIANS_PER_DEGREE)};
GlobalEditor.EllipsoidDataModel=function(a){GlobalEditor.DescriptorDataModel.call(this,a);this.add({type:"cesiumCartesian3",label:"radii",name:"radii"});this.add({type:"checkBox",label:"\u663e\u793a",name:"show"});this.add({type:"checkBox",label:"\u586b\u5145",name:"fill"});this.add({type:"cesiumMaterial",name:"material",label:"\u6750\u8d28"});this.add({type:"checkBox",name:"outline",label:"outline"});this.add({type:"color",name:"outlineColor",label:"outlineColor"});this.add({type:"input",name:"outlineWidth",
label:"outlineWidth"});this.add({type:"input",name:"subdivisions",label:"subdivisions"});this.add({type:"input",name:"stackPartitions",label:"stack Partitions"});this.add({type:"input",name:"slicePartitions",label:"slice Partitions"})};
GlobalEditor.EllipsoidDelegate=function(a){GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"radii",GlobalEditor.DescriptorDataModelHandle.cesiumProperty);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"show",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,void 0,!0);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"fill",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,void 0,!0);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"material");
GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"outline",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,void 0,!1);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"outlineColor",GlobalEditor.DescriptorDataModelHandle.cesiumColorProperty,GlobalEditor.DescriptorDataModelHandle.cesiumColorValue,Cesium.Color.BLACK);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"outlineWidth",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,GlobalEditor.DescriptorDataModelHandle.numberValue,
1);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"subdivisions",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,GlobalEditor.DescriptorDataModelHandle.numberValue,128);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"stackPartitions",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,GlobalEditor.DescriptorDataModelHandle.numberValue,64);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"slicePartitions",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,
GlobalEditor.DescriptorDataModelHandle.numberValue,64)};
GlobalEditor.LabelDataModel=function(a){GlobalEditor.DescriptorDataModel.call(this,a);this.add({type:"textArea",name:"text",label:"\u6587\u5b57"});this.add({type:"input",name:"font",label:"\u5b57\u4f53"});this.add({type:"dropdown",name:"style",label:"style",data:[{label:"FILL",value:Cesium.LabelStyle.FILL},{label:"FILL_AND_OUTLINE",value:Cesium.LabelStyle.FILL_AND_OUTLINE},{label:"OUTLINE",value:Cesium.LabelStyle.OUTLINE}]});this.add({type:"color",name:"fillColor",label:"fillColor"});this.add({type:"color",
name:"outlineColor",label:"outlineColor"});this.add({type:"input",name:"outlineWidth",label:"outlineWidth"});this.add({type:"checkBox",label:"\u663e\u793a",name:"show"});this.add({type:"slider",label:"\u7f29\u653e",name:"scale",min:0,max:10});this.add({type:"dropdown",label:"\u6c34\u5e73\u951a\u70b9",name:"horizontalOrigin",data:[{label:"\u5de6",value:Cesium.HorizontalOrigin.LEFT},{label:"\u4e2d",value:Cesium.HorizontalOrigin.CENTER},{label:"\u53f3",value:Cesium.HorizontalOrigin.RIGHT}]});this.add({type:"dropdown",
label:"\u5782\u76f4\u951a\u70b9",name:"verticalOrigin",data:[{label:"\u4e0a",value:Cesium.VerticalOrigin.TOP},{label:"\u4e2d",value:Cesium.VerticalOrigin.CENTER},{label:"\u4e0b",value:Cesium.VerticalOrigin.BOTTOM}]});this.add({type:"hline"});this.add({type:"cesiumCartesian3",label:"eyeOffset",name:"eyeOffset"});this.add({type:"cesiumCartesian2",label:"pixelOffset",name:"pixelOffset"});this.add({type:"input",label:"translucency By Distance",name:"translucencyByDistance"});this.add({type:"input",label:"pixelOffset Scale By Distance",
name:"pixelOffsetScaleByDistance"})};
GlobalEditor.LabelDelegate=function(a){GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"text",GlobalEditor.DescriptorDataModelHandle.cesiumProperty);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"font",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,GlobalEditor.DescriptorDataModelHandle.emptyToUndefined);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"style",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,GlobalEditor.DescriptorDataModelHandle.numberValue,
Cesium.LabelStyle.FILL);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"fillColor",GlobalEditor.DescriptorDataModelHandle.cesiumColorProperty,GlobalEditor.DescriptorDataModelHandle.cesiumColorValue,Cesium.Color.WHITE);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"outlineColor",GlobalEditor.DescriptorDataModelHandle.cesiumColorProperty,GlobalEditor.DescriptorDataModelHandle.cesiumColorValue,Cesium.Color.BLACK);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,
a,"outlineWidth",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,GlobalEditor.DescriptorDataModelHandle.numberValue,1);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"show",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,void 0,!0);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"scale",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,GlobalEditor.DescriptorDataModelHandle.numberValue,1);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"horizontalOrigin",
GlobalEditor.DescriptorDataModelHandle.cesiumProperty,GlobalEditor.DescriptorDataModelHandle.numberValue,Cesium.HorizontalOrigin.CENTER);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"verticalOrigin",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,GlobalEditor.DescriptorDataModelHandle.numberValue,Cesium.VerticalOrigin.CENTER);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"eyeOffset",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,void 0,Cesium.Cartesian3.ZERO);
GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"pixelOffset",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,void 0,Cesium.Cartesian2.ZERO);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"translucencyByDistance",GlobalEditor.DescriptorDataModelHandle.cesiumNearFarScalarString,GlobalEditor.DescriptorDataModelHandle.cesiumNearFarScalarValue);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"pixelOffsetScaleByDistance",GlobalEditor.DescriptorDataModelHandle.cesiumNearFarScalarString,
GlobalEditor.DescriptorDataModelHandle.cesiumNearFarScalarValue)};
GlobalEditor.ModelDataModel=function(a){GlobalEditor.DescriptorDataModel.call(this,a);this.add({type:"input",label:"\u5730\u5740",name:"uri"});this.add({type:"checkBox",label:"\u663e\u793a",name:"show"});this.add({type:"slider",label:"\u7f29\u653e",name:"scale",min:0,max:1E4});this.add({type:"input",label:"\u6700\u5c0f\u50cf\u7d20\u503c",name:"minimumPixelSize"});this.add({type:"input",label:"\u6700\u5927\u7f29\u653e\u503c",name:"maximumScale"});this.add({type:"checkBox",label:"\u589e\u91cf\u52a0\u8f7d<br>\u7eb9\u7406",
name:"incrementallyLoadTextures"});this.add({type:"checkBox",label:"\u6295\u5c04\u9634\u5f71",name:"castShadows"});this.add({type:"checkBox",label:"\u63a5\u53d7\u9634\u5f71",name:"receiveShadows"});this.add({type:"checkBox",label:"\u64ad\u653e\u52a8\u753b",name:"runAnimations"})};
GlobalEditor.ModelDelegate=function(a){GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"uri",GlobalEditor.DescriptorDataModelHandle.cesiumProperty);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"show",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,void 0,!0);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"scale",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,GlobalEditor.DescriptorDataModelHandle.numberValue,1);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,
a,"minimumPixelSize",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,GlobalEditor.DescriptorDataModelHandle.numberValue);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"maximumScale",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,GlobalEditor.DescriptorDataModelHandle.numberValue);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"incrementallyLoadTextures",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,void 0,!0);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,
a,"castShadows",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,void 0,!0);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"receiveShadows",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,void 0,!0);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"runAnimations",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,void 0,!0)};
GlobalEditor.PointDataModel=function(a){GlobalEditor.DescriptorDataModel.call(this,a);this.add({type:"color",name:"color",label:"\u989c\u8272"});this.add({type:"input",name:"pixelSize",label:"pixelSize"});this.add({type:"color",name:"outlineColor",label:"outlineColor"});this.add({type:"input",name:"outlineWidth",label:"outlineWidth"});this.add({type:"checkBox",label:"\u663e\u793a",name:"show"});this.add({type:"input",label:"scale By Distance",name:"scaleByDistance"});this.add({type:"input",label:"translucency By Distance",
name:"translucencyByDistance"})};
GlobalEditor.PointDelegate=function(a){GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"color",GlobalEditor.DescriptorDataModelHandle.cesiumColorProperty,GlobalEditor.DescriptorDataModelHandle.cesiumColorValue,Cesium.Color.WHITE);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"pixelSize",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,GlobalEditor.DescriptorDataModelHandle.numberValue,1);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"outlineColor",
GlobalEditor.DescriptorDataModelHandle.cesiumColorProperty,GlobalEditor.DescriptorDataModelHandle.cesiumColorValue,Cesium.Color.BLACK);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"outlineWidth",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,GlobalEditor.DescriptorDataModelHandle.numberValue,0);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"show",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,void 0,!0);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,
a,"scaleByDistance",GlobalEditor.DescriptorDataModelHandle.cesiumNearFarScalarString,GlobalEditor.DescriptorDataModelHandle.cesiumNearFarScalarValue);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"translucencyByDistance",GlobalEditor.DescriptorDataModelHandle.cesiumNearFarScalarString,GlobalEditor.DescriptorDataModelHandle.cesiumNearFarScalarValue)};
GlobalEditor.PolygonDataModel=function(a){GlobalEditor.DescriptorDataModel.call(this,a);this.add({type:"textArea",name:"hierarchy",label:"hierarchy"});this.add({type:"input",name:"height",label:"\u9ad8"});this.add({type:"input",name:"extrudedHeight",label:"extruded height"});this.add({type:"checkBox",name:"show",label:"\u663e\u793a"});this.add({type:"checkBox",name:"fill",label:"\u586b\u5145"});this.add({type:"cesiumMaterial",name:"material",label:"\u6750\u8d28"});this.add({type:"checkBox",name:"outline",
label:"outline"});this.add({type:"color",name:"outlineColor",label:"outlineColor"});this.add({type:"input",name:"outlineWidth",label:"outlineWidth"});this.add({type:"slider",label:"stRotation",name:"stRotation",min:-360,max:360});this.add({type:"input",name:"granularity",label:"granularity"});this.add({type:"checkBox",name:"perPositionHeight",label:"perPosition Height"});this.add({type:"checkBox",name:"closeTop",label:"closeTop"});this.add({type:"checkBox",name:"closeBottom",label:"closeBottom"})};
GlobalEditor.PolygonDelegate=function(a){GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"hierarchy",GlobalEditor.DescriptorDataModelHandle.cesiumPositionsString,GlobalEditor.DescriptorDataModelHandle.cesiumPositionsValue);this.getHeight=function(){return GlobalEditor.CesiumUtil.getPropertyValue(a.height)};this.setHeight=function(b){var c=GlobalEditor.CesiumUtil.getPropertyValue(a.perPositionHeight);a.height=c?void 0:Number(b)};this.getPerPositionHeight=function(){return GlobalEditor.CesiumUtil.getPropertyValue(a.perPositionHeight)};
this.setPerPositionHeight=function(b){if(b)a.height=void 0;a.perPositionHeight=b};GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"extrudedHeight",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,GlobalEditor.DescriptorDataModelHandle.numberValue);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"show",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,void 0,!0);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"fill",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,
void 0,!0);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"material");GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"outline",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,void 0,!1);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"outlineColor",GlobalEditor.DescriptorDataModelHandle.cesiumColorProperty,GlobalEditor.DescriptorDataModelHandle.cesiumColorValue,Cesium.Color.BLACK);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"outlineWidth",
GlobalEditor.DescriptorDataModelHandle.cesiumProperty,GlobalEditor.DescriptorDataModelHandle.numberValue,1);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"stRotation",GlobalEditor.DescriptorDataModelHandle.cesiumDegress,GlobalEditor.DescriptorDataModelHandle.cesiumRadiansValue,0);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"granularity",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,GlobalEditor.DescriptorDataModelHandle.numberValue,Cesium.Math.RADIANS_PER_DEGREE);
GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"closeTop",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,void 0,!0);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"closeBottom",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,void 0,!0)};
GlobalEditor.PolylineDataModel=function(a){GlobalEditor.DescriptorDataModel.call(this,a);this.add({type:"textArea",name:"positions",label:"positions"});this.add({type:"checkBox",name:"followSurface",label:"follow Surface"});this.add({type:"input",name:"width",label:"\u5bbd"});this.add({type:"checkBox",name:"show",label:"\u663e\u793a"});this.add({type:"cesiumMaterial",name:"material",label:"\u6750\u8d28"});this.add({type:"input",name:"granularity",label:"granularity"})};
GlobalEditor.PolylineDelegate=function(a){GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"positions",GlobalEditor.DescriptorDataModelHandle.cesiumPositionsString,GlobalEditor.DescriptorDataModelHandle.cesiumPositionsValue);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"followSurface",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,void 0,!0);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"width",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,
GlobalEditor.DescriptorDataModelHandle.numberValue,1);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"show",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,void 0,!0);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"material");GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"granularity",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,GlobalEditor.DescriptorDataModelHandle.numberValue,Cesium.Math.RADIANS_PER_DEGREE)};
GlobalEditor.PolylineVolumeDataModel=function(a){GlobalEditor.DescriptorDataModel.call(this,a);this.add({type:"textArea",name:"positions",label:"positions"});this.add({type:"textArea",name:"shape",label:"shape"});this.add({type:"dropdown",name:"cornerType",label:"cornerType",data:[{label:"ROUNDED",value:Cesium.CornerType.ROUNDED},{label:"BEVELED",value:Cesium.CornerType.BEVELED},{label:"MITERED",value:Cesium.CornerType.MITERED}]});this.add({type:"checkBox",name:"show",label:"\u663e\u793a"});this.add({type:"checkBox",
name:"fill",label:"\u586b\u5145"});this.add({type:"cesiumMaterial",name:"material",label:"\u6750\u8d28"});this.add({type:"checkBox",name:"outline",label:"outline"});this.add({type:"color",name:"outlineColor",label:"outlineColor"});this.add({type:"input",name:"outlineWidth",label:"outlineWidth"});this.add({type:"input",name:"granularity",label:"granularity"})};
GlobalEditor.PolylineVolumeDelegate=function(a){GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"positions",GlobalEditor.DescriptorDataModelHandle.cesiumPositionsString,GlobalEditor.DescriptorDataModelHandle.cesiumPositionsValue);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"shape",GlobalEditor.DescriptorDataModelHandle.cesiumCartesian2ArrayString,GlobalEditor.DescriptorDataModelHandle.cesiumCartesian2ArrayValue);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,
a,"cornerType",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,void 0,Cesium.CornerType.ROUNDED);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"show",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,void 0,!0);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"fill",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,void 0,!0);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"material");GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,
a,"outline",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,void 0,!1);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"outlineColor",GlobalEditor.DescriptorDataModelHandle.cesiumColorProperty,GlobalEditor.DescriptorDataModelHandle.cesiumColorValue,Cesium.Color.BLACK);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"outlineWidth",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,GlobalEditor.DescriptorDataModelHandle.numberValue,1);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,
a,"granularity",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,GlobalEditor.DescriptorDataModelHandle.numberValue,Cesium.Math.RADIANS_PER_DEGREE)};
GlobalEditor.RectangleDataModel=function(a){GlobalEditor.DescriptorDataModel.call(this,a);this.add({type:"textArea",name:"coordinates",label:"coordinates"});this.add({type:"input",name:"height",label:"\u9ad8"});this.add({type:"input",name:"extrudedHeight",label:"extruded height"});this.add({type:"checkBox",name:"closeTop",label:"closeTop"});this.add({type:"checkBox",name:"closeBottom",label:"closeBottom"});this.add({type:"checkBox",name:"show",label:"\u663e\u793a"});this.add({type:"checkBox",name:"fill",
label:"\u586b\u5145"});this.add({type:"cesiumMaterial",name:"material",label:"\u6750\u8d28"});this.add({type:"checkBox",name:"outline",label:"outline"});this.add({type:"color",name:"outlineColor",label:"outlineColor"});this.add({type:"input",name:"outlineWidth",label:"outlineWidth"});this.add({type:"slider",label:"\u65cb\u8f6c",name:"rotation",min:-360,max:360});this.add({type:"slider",label:"stRotation",name:"stRotation",min:-360,max:360});this.add({type:"input",name:"granularity",label:"granularity"})};
GlobalEditor.RectangleDelegate=function(a){GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"coordinates",GlobalEditor.DescriptorDataModelHandle.cesiumRectangleString,GlobalEditor.DescriptorDataModelHandle.cesiumRectangleValue);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"height",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,GlobalEditor.DescriptorDataModelHandle.numberValue,0);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"extrudedHeight",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,
GlobalEditor.DescriptorDataModelHandle.numberValue);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"closeTop",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,void 0,!0);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"closeBottom",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,void 0,!0);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"show",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,void 0,!0);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,
a,"fill",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,void 0,!0);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"material");GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"outline",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,void 0,!1);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"outlineColor",GlobalEditor.DescriptorDataModelHandle.cesiumColorProperty,GlobalEditor.DescriptorDataModelHandle.cesiumColorValue,Cesium.Color.BLACK);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,
a,"outlineWidth",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,GlobalEditor.DescriptorDataModelHandle.numberValue,1);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"rotation",GlobalEditor.DescriptorDataModelHandle.cesiumDegress,GlobalEditor.DescriptorDataModelHandle.cesiumRadiansValue,0);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"stRotation",GlobalEditor.DescriptorDataModelHandle.cesiumDegress,GlobalEditor.DescriptorDataModelHandle.cesiumRadiansValue,0);
GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"granularity",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,GlobalEditor.DescriptorDataModelHandle.numberValue,Cesium.Math.RADIANS_PER_DEGREE)};
GlobalEditor.WallDataModel=function(a){GlobalEditor.DescriptorDataModel.call(this,a);this.add({type:"textArea",name:"positions",label:"positions"});this.add({type:"textArea",name:"maximumHeights",label:"maximumHeights"});this.add({type:"textArea",name:"minimumHeights",label:"minimumHeights"});this.add({type:"checkBox",name:"show",label:"\u663e\u793a"});this.add({type:"checkBox",name:"fill",label:"\u586b\u5145"});this.add({type:"cesiumMaterial",name:"material",label:"\u6750\u8d28"});this.add({type:"checkBox",
name:"outline",label:"outline"});this.add({type:"color",name:"outlineColor",label:"outlineColor"});this.add({type:"input",name:"outlineWidth",label:"outlineWidth"});this.add({type:"input",name:"granularity",label:"granularity"})};
GlobalEditor.WallDelegate=function(a){GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"positions",GlobalEditor.DescriptorDataModelHandle.cesiumPositionsString,GlobalEditor.DescriptorDataModelHandle.cesiumPositionsValue);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"maximumHeights",GlobalEditor.DescriptorDataModelHandle.cesiumArrayString,GlobalEditor.DescriptorDataModelHandle.cesiumArrayValue);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"minimumHeights",
GlobalEditor.DescriptorDataModelHandle.cesiumArrayString,GlobalEditor.DescriptorDataModelHandle.cesiumArrayValue);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"show",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,void 0,!0);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"fill",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,void 0,!0);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"material");GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,
a,"outline",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,void 0,!1);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"outlineColor",GlobalEditor.DescriptorDataModelHandle.cesiumColorProperty,GlobalEditor.DescriptorDataModelHandle.cesiumColorValue,Cesium.Color.BLACK);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"outlineWidth",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,GlobalEditor.DescriptorDataModelHandle.numberValue,1);GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,
a,"granularity",GlobalEditor.DescriptorDataModelHandle.cesiumProperty,GlobalEditor.DescriptorDataModelHandle.numberValue,Cesium.Math.RADIANS_PER_DEGREE)};
GlobalEditor.EntityDataModel=function(a){GlobalEditor.DescriptorDataModel.call(this,a);var b=this;this.add({type:"input",label:"id",name:"id"});this.add({type:"input",label:"\u540d\u79f0",name:"name"});this.add({type:"checkBox",label:"\u663e\u793a",name:"show"});this.add({type:"hline"});this.add({type:"cesiumCartographic",label:"\u4f4d\u7f6e",name:"position"});this.add({type:"cesiumOrientation",label:"\u65b9\u5411",name:"orientation"});$.each([{name:"billboard",dataModelClass:GlobalEditor.BillboardDataModel,
delegateClass:GlobalEditor.BillboardDelegate},{name:"box",dataModelClass:GlobalEditor.BoxDataModel,delegateClass:GlobalEditor.BoxDelegate},{name:"corridor",dataModelClass:GlobalEditor.CorridorDataModel,delegateClass:GlobalEditor.CorridorDelegate},{name:"cylinder",dataModelClass:GlobalEditor.CylinderDataModel,delegateClass:GlobalEditor.CylinderDelegate},{name:"ellipse",dataModelClass:GlobalEditor.EllipseDataModel,delegateClass:GlobalEditor.EllipseDelegate},{name:"ellipsoid",dataModelClass:GlobalEditor.EllipsoidDataModel,
delegateClass:GlobalEditor.EllipsoidDelegate},{name:"label",dataModelClass:GlobalEditor.LabelDataModel,delegateClass:GlobalEditor.LabelDelegate},{name:"model",dataModelClass:GlobalEditor.ModelDataModel,delegateClass:GlobalEditor.ModelDelegate},{name:"point",dataModelClass:GlobalEditor.PointDataModel,delegateClass:GlobalEditor.PointDelegate},{name:"polygon",dataModelClass:GlobalEditor.PolygonDataModel,delegateClass:GlobalEditor.PolygonDelegate},{name:"polyline",dataModelClass:GlobalEditor.PolylineDataModel,
delegateClass:GlobalEditor.PolylineDelegate},{name:"polylineVolume",dataModelClass:GlobalEditor.PolylineVolumeDataModel,delegateClass:GlobalEditor.PolylineVolumeDelegate},{name:"rectangle",dataModelClass:GlobalEditor.RectangleDataModel,delegateClass:GlobalEditor.RectangleDelegate},{name:"wall",dataModelClass:GlobalEditor.WallDataModel,delegateClass:GlobalEditor.WallDelegate}],function(){if(a.entity[this.name]!=void 0){b.add({type:"header",label:this.name});var c=new this.dataModelClass(new this.delegateClass(a.entity[this.name]));
c.name=this.name;b.add(c)}});this.add({type:"hline"});this.add({type:"textArea",label:"\u63cf\u8ff0",name:"description"})};
GlobalEditor.EntityDelegate=function(a){var b=this;this.entity=a;GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"id");GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"name");GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"show");GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"description",GlobalEditor.DescriptorDataModelHandle.cesiumProperty);this.getPosition=function(){var b=GlobalEditor.CesiumUtil.getPropertyValue(a.position);return Cesium.Cartographic.fromCartesian(b)};
this.setPosition=function(b){a.position=Cesium.Cartesian3.fromRadians(b.longitude,b.latitude,b.height)};this.orientationConfig={heading:0,pitch:0,roll:0};this.getOrientation=function(){return b.orientationConfig};this.setOrientation=function(c){b.orientationConfig=c;var e=GlobalEditor.CesiumUtil.getPropertyValue(a.position),d=Cesium.Math.toRadians(c.heading),f=Cesium.Math.toRadians(c.pitch),c=Cesium.Math.toRadians(c.roll);a.orientation=Cesium.Transforms.headingPitchRollQuaternion(e,d,f,c)}};
GlobalEditor.CameraDataModel=function(a){GlobalEditor.DescriptorDataModel.call(this,a);this.add({type:"cesiumCartesian3",name:"direction",label:"\u65b9\u5411"});this.add({type:"cesiumCartesian3",name:"position",label:"\u4f4d\u7f6e"});this.add({type:"cesiumCartographic",name:"positionCartographic",label:"\u5730\u56fe\u4f4d\u7f6e"});this.add({type:"cesiumCartesian3",name:"right",label:"\u53f3"});this.add({type:"cesiumCartesian3",name:"up",label:"\u4e0a"})};
GlobalEditor.CameraDelegate=function(a){GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"direction");GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"position");GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"positionCartographic");GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"right");GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"up")};
GlobalEditor.SkyAtmosphereDataModel=function(a){GlobalEditor.DescriptorDataModel.call(this,a);this.add({type:"checkBox",label:"\u663e\u793a",name:"show"});this.add({type:"slider",label:"\u8272\u76f8\u504f\u79fb",name:"hueShift",min:-1,max:1});this.add({type:"slider",label:"\u9971\u548c\u5ea6\u504f\u79fb",name:"saturationShift",min:-1,max:1});this.add({type:"slider",label:"\u4eae\u5ea6\u504f\u79fb",name:"brightnessShift",min:-1,max:1})};
GlobalEditor.SkyAtmosphereDelegate=function(a){GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"show");GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"hueShift");GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"saturationShift");GlobalEditor.DescriptorDataModel.createGetterAndSetter(this,a,"brightnessShift")};GlobalEditor.DescItemMap={};GlobalEditor.DescItemMap.create=function(a,b,c){return new this[a.type](a,b,c)};
GlobalEditor.DescItemMap.checkBox=function(a,b,c){var e=GlobalEditor.FormViewManager.createCheckBoxView(a.label);e.appendTo(c);var a=b.getAndSetFuncForName(a.name),d=a[0],f=a[1],g=e.find(".ui.checkbox").eq(0);g.checkbox(d()?"set checked":"set unchecked");g.checkbox({onChange:function(){var a=d(),b=g.checkbox("is checked");GlobalEditor.HistoryManager.addEditAction("edit",a,b,function(a){f(a);g.checkbox(a?"set checked":"set unchecked")})}})};
GlobalEditor.DescItemMap.color=function(a,b,c){var e=GlobalEditor.FormViewManager.createColorPickerView(a.label);e.appendTo(c);var a=b.getAndSetFuncForName(a.name),d=a[1],f=(0,a[0])(),g=new GlobalEditor.ColorPicker(f,e.find(".colorPicker"));g.onChange=function(a){d(a)};g.onSubmit=function(a){f!=a&&GlobalEditor.HistoryManager.addEditAction("edit",f,a,function(a){g.setColor(a);d(a);f=a})}};
GlobalEditor.DescItemMap.dropdown=function(a,b,c){var e=new GlobalEditor.Dropdown(a.label,a.data);e.view.appendTo(c);var a=b.getAndSetFuncForName(a.name),d=a[0],f=a[1];e.setValue(d());e.onChange=function(a){var b=d();GlobalEditor.HistoryManager.addEditAction("edit",b,a,function(a){f(a);e.setValue(a)})}};GlobalEditor.DescItemMap.header=function(a,b,c){GlobalEditor.FormViewManager.createHeader(a.label).appendTo(c)};GlobalEditor.DescItemMap.hline=function(a,b,c){GlobalEditor.FormViewManager.createHline().appendTo(c)};
GlobalEditor.DescItemMap.html=function(a,b,c){$(a.html).appendTo(c)};GlobalEditor.DescItemMap.input=function(a,b,c){var e=GlobalEditor.FormViewManager.createTextInputView(a.label);e.appendTo(c);var a=b.getAndSetFuncForName(a.name),d=a[0],f=a[1],g=e.find("input").eq(0);g.val(d());g.change(function(){var a=d(),b=g.val();GlobalEditor.HistoryManager.addEditAction("edit",a,b,function(a){f(a);g.val(a)})})};
GlobalEditor.DescItemMap.position=function(a,b,c){var e=GlobalEditor.FormViewManager.createPositionView();e.appendTo(c);var a=b.getAndSetFuncForName(a.name),d=a[0],f=a[1],e=e.find("input"),g=e.eq(0),h=e.eq(1);g.val(d().x);h.val(d().y);g.change(function(){var a=d(),b=d();b.x=Number(g.val());GlobalEditor.HistoryManager.addEditAction("edit",a,b,function(a){f(a);g.val(a.x)})});h.change(function(){var a=d(),b=d();b.y=Number(h.val());GlobalEditor.HistoryManager.addEditAction("edit",a,b,function(a){f(a);
h.val(a.y)})});this.update=function(){g.val(d().x);h.val(d().y)}};GlobalEditor.DescItemMap.size=function(a,b,c){var e=GlobalEditor.FormViewManager.createSizeView();e.appendTo(c);var a=b.getAndSetFuncForName(a.name),d=a[0],f=a[1],e=e.find("input"),g=e.eq(0),h=e.eq(1),e=d();g.val(e.width);h.val(e.height);$.each([g,h],function(){this.change(function(){var a=d(),b=g.val(),c=h.val();GlobalEditor.HistoryManager.addEditAction("edit",a,{width:b,height:c},function(a){f(a);g.val(a.width);h.val(a.height)})})})};
GlobalEditor.DescItemMap.slider=function(a,b,c){var e=GlobalEditor.FormViewManager.createSliderView(a.label);e.appendTo(c);var b=b.getAndSetFuncForName(a.name),c=b[0],d=b[1],f=new GlobalEditor.Slider(e,a.min,a.max,c()),g=c();f.onUpdate=function(a){d(a)};f.onChange=function(a){GlobalEditor.HistoryManager.addEditAction("edit",g,a,function(a){f.setValue(a);d(a);g=a})}};
GlobalEditor.DescItemMap.tabs=function(a,b,c){var e=GlobalEditor.FormViewManager.createButtonGroupView(a.label,a.items);e.appendTo(c);var a=b.getAndSetFuncForName(a.name),d=a[0],f=a[1],g=new GlobalEditor.ButtonGroupSwitcher(e,d());g.onChange=function(a){var b=d();GlobalEditor.HistoryManager.addEditAction("edit",b,a,function(a){f(a);g.setValue(a)})}};
GlobalEditor.DescItemMap.textArea=function(a,b,c){var e=GlobalEditor.FormViewManager.createTextAreaView(a.label);e.appendTo(c);var a=b.getAndSetFuncForName(a.name),d=a[0],f=a[1],g=e.find("textarea").eq(0);g.val(d());g.change(function(){var a=d(),b=g.val();GlobalEditor.HistoryManager.addEditAction("edit",a,b,function(a){f(a);g.val(a)})})};
GlobalEditor.DescItemMap.cesiumCartesian3=function(a,b,c){var e=GlobalEditor.FormViewManager.createCesiumCartesian3View(a.label);e.appendTo(c);var a=b.getAndSetFuncForName(a.name),d=a[0],f=a[1],e=e.find("input"),g=e.eq(0),h=e.eq(1),j=e.eq(2),e=d();g.val(e.x);h.val(e.y);j.val(e.z);$.each([g,h,j],function(){this.change(function(){var a=d(),b=Number(g.val()),c=Number(h.val()),e=Number(j.val()),b=new Cesium.Cartesian3(b,c,e);GlobalEditor.HistoryManager.addEditAction("edit",a,b,function(a){f(a);g.val(a.x);
h.val(a.y);j.val(a.z)})})});this.update=function(){var a=d();g.val(a.x);h.val(a.y);j.val(a.z)}};
GlobalEditor.DescItemMap.cesiumCartesian2=function(a,b,c){var e=GlobalEditor.FormViewManager.createCesiumCartesian2View(a.label);e.appendTo(c);var a=b.getAndSetFuncForName(a.name),d=a[0],f=a[1],e=e.find("input"),g=e.eq(0),h=e.eq(1),e=d();g.val(e.x);h.val(e.y);$.each([g,h],function(){this.change(function(){var a=d(),b=Number(g.val()),c=Number(h.val()),b=new Cesium.Cartesian2(b,c);GlobalEditor.HistoryManager.addEditAction("edit",a,b,function(a){f(a);g.val(a.x);h.val(a.y)})})})};
GlobalEditor.DescItemMap.cesiumCartographic=function(a,b,c){var e=GlobalEditor.FormViewManager.createCesiumCartesian3View(a.label);e.appendTo(c);var d=e.find("label");$.each(["lng","lat","\u9ad8"],function(a){d.eq(a+1).text(this)});var a=b.getAndSetFuncForName(a.name),f=a[0],g=a[1],e=e.find("input"),h=e.eq(0),j=e.eq(1),i=e.eq(2),b=f(),e=Cesium.Math.toDegrees(b.longitude),a=Cesium.Math.toDegrees(b.latitude),b=b.height;j.val(a);h.val(e);i.val(b);$.each([j,h,i],function(){this.change(function(){var a=
f(),b=Number(h.val()),c=Number(j.val()),d=Number(i.val()),b=Cesium.Cartographic.fromDegrees(b,c,d);GlobalEditor.HistoryManager.addEditAction("edit",a,b,function(a){g(a);var b=Cesium.Math.toDegrees(a.longitude),c=Cesium.Math.toDegrees(a.latitude),a=a.height;j.val(c);h.val(b);i.val(a)})})});this.update=function(){var a=f(),b=Cesium.Math.toDegrees(a.longitude),c=Cesium.Math.toDegrees(a.latitude),a=a.height;j.val(c);h.val(b);i.val(a)}};
GlobalEditor.DescItemMap.cesiumOrientation=function(a,b,c){var e=GlobalEditor.FormViewManager.createCesiumOrientationView(a.label);e.appendTo(c);var a=b.getAndSetFuncForName(a.name),d=a[1],f=(0,a[0])(),e=e.find(".eleven.wide").children(),g=["heading","pitch","roll"],h=new GlobalEditor.Slider(e.eq(0),-360,360,f[g[0]]),j=new GlobalEditor.Slider(e.eq(1),-360,360,f[g[1]]),i=new GlobalEditor.Slider(e.eq(2),-360,360,f[g[2]]);$.each([h,j,i],function(a){this.onUpdate=function(b){var c=GlobalEditor.ObjectUtil.clone(f);
c[g[a]]=b;d(c)};this.onChange=function(b){var c=GlobalEditor.ObjectUtil.clone(f);c[g[a]]=b;GlobalEditor.HistoryManager.addEditAction("edit",f,c,function(a){h.setValue(a[g[0]]);j.setValue(a[g[1]]);i.setValue(a[g[2]]);d(a);f=a})}})};
GlobalEditor.DescItemMap.cesiumMaterial=function(a,b,c){var e=GlobalEditor.FormViewManager.createCesiumMaterialView(a.label);e.appendTo(c);var a=b.getAndSetFuncForName(a.name),d=a[0],f=a[1];e.find("button").eq(0).click(function(){var a=d();GlobalEditor.editMaterialWin.openForEditMaterial(a,function(b){GlobalEditor.HistoryManager.addEditAction("edit",a,b,function(a){f(a)})})})};
GlobalEditor.DataSourceManager=function(){return{dataSources:[],add:function(a){var b=GlobalEditor.editorContainer.viewer.dataSources;!b.contains(a.controller.dataSource)&&a.actived&&b.add(a.controller.dataSource);this.dataSources.push(a)},remove:function(a){var b=GlobalEditor.editorContainer.viewer.dataSources;b.contains(a.controller.dataSource)&&b.remove(a.controller.dataSource);this.dataSources.splice(this.dataSources.indexOf(a),1)}}}();
GlobalEditor.ImageLayerManager=function(){return{layers:[],add:function(a,b){this.layers.splice(b,0,a);var c=GlobalEditor.editorContainer.viewer.imageryLayers;a.layer==null&&a.initLayer();c.add(a.layer,b)},remove:function(a){this.layers.splice(this.layers.indexOf(a),1);GlobalEditor.editorContainer.viewer.imageryLayers.remove(a.layer,!0);a.layer=null},moveLayerUp:function(a){GlobalEditor.editorContainer.viewer.imageryLayers.lower(a.layer)},moveLayerDown:function(a){GlobalEditor.editorContainer.viewer.imageryLayers.raise(a.layer)}}}();
GlobalEditor.BaseTool=function(){this.selected=!1;this.cursor="auto";this.init=function(){};this.initObj=function(){};this.setSelected=function(a){this.selected=a;this.setCursor(this.cursor)};this.setCursor=function(a){GlobalEditor.editorContainer.container.css("cursor",a)}};GlobalEditor.NormalTool=function(){GlobalEditor.BaseTool.call(this);this.descriptor=new GlobalEditor.ViewerDescriptor};
GlobalEditor.ToolManager=function(){var a={},b=-1,c=[];a.init=function(){c.push(new GlobalEditor.NormalTool);$.each(c,function(){this.init()});this.selectToolIdx(0)};a.getSelectedIdx=function(){return b};a.getTools=function(){return c};a.selectToolIdx=function(a){var d;b>-1&&(d=c[b],d.setSelected(!1));d=c[a];d.setSelected(!0);b=a;GlobalEditor.propertiesPanel.update()};a.initObj=function(a){$.each(c,function(){this.initObj(a)})};return a}();
GlobalEditor.BasicDataSourceController=function(a){var b=this;this.dataSource=null;this.initWithString=function(){};this.initWithUrl=function(){};this.initWithJs=function(a){try{this.dataSource=eval(a),this.checkIsDataSource(this.dataSource)||(GlobalEditor.Alert.show("\u521b\u5efa\u6570\u636e\u6e90\u5931\u8d25!"),b.initWithBlank())}catch(e){GlobalEditor.Alert.show(e),b.initWithBlank()}};this.initWithBlank=function(){};this.init=function(){switch(a.type){case "string":this.initWithString(a.string);
break;case "url":this.initWithUrl(a.url);break;case "js":this.initWithJs(a.js);break;case "blank":this.initWithBlank()}};this.checkIsDataSource=function(a){for(var b=[Cesium.CzmlDataSource,Cesium.GeoJsonDataSource,Cesium.CustomDataSource,Cesium.KmlDataSource],d=!1,f=0;f<b.length;f++)if(a instanceof b[f]){d=!0;break}return d}};
GlobalEditor.CzmlDataSourceController=function(a){GlobalEditor.BasicDataSourceController.call(this,a);this.initWithString=function(a){this.initWithBlank();try{this.dataSource.load(JSON.parse(a))}catch(c){GlobalEditor.Alert.show(c)}};this.initWithUrl=function(a){this.initWithBlank();this.dataSource.load(a)};this.initWithBlank=function(){this.dataSource=new Cesium.CzmlDataSource};this.init()};
GlobalEditor.GeoJsonDataSourceController=function(a){GlobalEditor.BasicDataSourceController.call(this,a);this.initWithString=function(a){this.initWithBlank();try{this.dataSource.load(JSON.parse(a))}catch(c){GlobalEditor.Alert.show(c)}};this.initWithUrl=function(a){this.initWithBlank();this.dataSource.load(a)};this.initWithBlank=function(){this.dataSource=new Cesium.GeoJsonDataSource};this.init()};
GlobalEditor.TopoJsonDataSourceController=function(a){GlobalEditor.GeoJsonDataSourceController.call(this,a)};
GlobalEditor.KmlDataSourceController=function(a){GlobalEditor.BasicDataSourceController.call(this,a);this.initWithString=function(a){this.initWithBlank();try{this.dataSource.load($.parseXML(a))}catch(c){GlobalEditor.Alert.show(c)}};this.initWithUrl=function(a){this.initWithBlank();this.dataSource.load(a)};this.initWithBlank=function(){this.dataSource=new Cesium.KmlDataSource({camera:GlobalEditor.editorContainer.viewer.camera,canvas:GlobalEditor.editorContainer.viewer.canvas})};this.init()};
GlobalEditor.CustomDataSourceController=function(a){GlobalEditor.BasicDataSourceController.call(this,a);var b=this;this.initWithString=function(a){this.initWithBlank();this.load(a)};this.initWithUrl=function(a){this.initWithBlank();$.get(a,function(a){b.load(a)})};this.initWithBlank=function(){this.dataSource=new Cesium.CustomDataSource};this.load=function(a){try{var e=eval(a);$.each(e,function(){b.dataSource.entities.add(this)})}catch(d){GlobalEditor.Alert.show(d)}};this.init()};
GlobalEditor.DataSource=function(a){this.info=a;this.controller=null;var b={CZML:GlobalEditor.CzmlDataSourceController,GeoJSON:GlobalEditor.GeoJsonDataSourceController,TopoJSON:GlobalEditor.TopoJsonDataSourceController,KML:GlobalEditor.KmlDataSourceController,Custom:GlobalEditor.CustomDataSourceController};this.actived=!1;var c=b[a["class"]];this.controller=new c(a);this.setActive=function(a){var b=GlobalEditor.editorContainer.viewer.dataSources,c=b.contains(this.controller.dataSource);if(a){if(c)return;
b.add(this.controller.dataSource)}else c&&b.remove(this.controller.dataSource);this.actived=a};this.updateInfo=function(a){var b=GlobalEditor.editorContainer.viewer.dataSources;b.contains(this.controller.dataSource)&&b.remove(this.controller.dataSource);this.info=a;this.controller=new c(this.info);this.actived&&b.add(this.controller.dataSource)}};
GlobalEditor.ImageLayer=function(a){this.info=a;this.imageLayerAdjust=new GlobalEditor.ImageLayerAdjust(this);this.imageLayerAdjustDescriptor=new GlobalEditor.ImageLayerAdjustDescriptor(this.imageLayerAdjust);this.initLayer=function(){var a=this.initProvider(this.info.js);this.layer=new Cesium.ImageryLayer(a);this.imageLayerAdjust.update()};this.initProvider=function(a){var c;try{c=eval(a),this.checkIsImageryProvider(c)||(GlobalEditor.Alert.show("\u751f\u6210ImageryProvider\u5931\u8d25!"),c=new Cesium.TileCoordinatesImageryProvider)}catch(e){GlobalEditor.Alert.show(e),
c=new Cesium.TileCoordinatesImageryProvider}return c};this.checkIsImageryProvider=function(a){for(var c=[Cesium.ArcGisMapServerImageryProvider,Cesium.TileCoordinatesImageryProvider,Cesium.WebMapTileServiceImageryProvider,Cesium.BingMapsImageryProvider,Cesium.GoogleEarthImageryProvider,Cesium.MapboxImageryProvider,Cesium.UrlTemplateImageryProvider,Cesium.GridImageryProvider,Cesium.SingleTileImageryProvider,Cesium.WebMapServiceImageryProvider],e=!1,d=0;d<c.length;d++)if(a instanceof c[d]){e=!0;break}return e};
this.initLayer();this.updateInfo=function(a){var c=GlobalEditor.editorContainer.viewer.imageryLayers,e=c.indexOf(this.layer);c.remove(this.layer,!0);this.info=a;this.initLayer();c.add(this.layer,e)}};GlobalEditor.ImageLayerAdjust=function(a){this.settings={alpha:1,brightness:1,contrast:1,hue:0,saturation:1,gamma:1,show:!0};this.update=function(){for(key in this.settings)a.layer[key]=this.settings[key]};this.setSettings=function(a){for(key in a)this.settings[key]=a[key];this.update()}};
GlobalEditor.EditorContainer=function(a){this.container=a;Cesium.BingMapsApi.defaultKey="AknGwyGtxa9zlcMazOG8GVPwpFATmyYf5GQOSwOMqTd-JTKe8h4Qwdu0WJRgQvfi";this.viewer=new Cesium.Viewer(a.attr("id"),{contextOptions:{webgl:{preserveDrawingBuffer:!0},allowTextureFilterAnisotropic:!1}});this.viewer.scene.fxaa=!1;this.flyToSelectedItem=function(){this.viewer.selectedEntity!=null&&this.viewer.flyTo(this.viewer.selectedEntity)};this.flyHome=function(){this.viewer.camera.flyHome()};this.getSettings=function(){var a=
{};a.viewer=GlobalEditor.ToolManager.getTools()[0].descriptor.getSettings();return a};this.setSettings=function(a){GlobalEditor.ToolManager.getTools()[0].descriptor.setSettings(a.viewer);GlobalEditor.propertiesPanel.update()};this.clear=function(){GlobalEditor.ToolManager.getTools()[0].descriptor.clear();GlobalEditor.propertiesPanel.update()}};
GlobalEditor.Terrain=function(){this.useDefault=!0;this.typeIdx=0;this.Providers=[Cesium.CesiumTerrainProvider,Cesium.ArcGisImageServerTerrainProvider,Cesium.VRTheWorldTerrainProvider];this.providerSettings=[{url:"https://assets.agi.com/stk-terrain/world",requestVertexNormals:!0,requestWaterMask:!0},{url:"https://elevation.arcgisonline.com/ArcGIS/rest/services/WorldElevation/DTMEllipsoidal/ImageServer",token:"KED1aF_I4UzXOHy3BnhwyBHU4l5oY6rO6walkmHoYqGp4XyIWUd5YZUC1ZrLAzvV40pR6gBXQayh0eFA8m6vPg..",
proxy:new Cesium.DefaultProxy("/terrain/")},{url:"http://www.vr-theworld.com/vr-theworld/tiles1.0.0/73/"}];this.defaultProvider=GlobalEditor.editorContainer.viewer.terrainProvider;this.update=function(){var a=this.useDefault?this.defaultProvider:new this.Providers[this.typeIdx](this.providerSettings[this.typeIdx]);GlobalEditor.editorContainer.viewer.terrainProvider=a}};GlobalEditor.RectUtil={};
GlobalEditor.RectUtil.testRectCross=function(a,b){var c,e,d,f;c=a.x+a.width/2;e=a.y+a.height/2;d=b.x+b.width/2;f=b.y+b.height/2;return Math.abs(c-d)<=a.width/2+b.width/2&&Math.abs(e-f)<=a.height/2+b.height/2};GlobalEditor.RectUtil.merge=function(a,b){var c={};c.x=a.x<b.x?a.x:b.x;c.y=a.y<b.y?a.y:b.y;c.width=a.x+a.width>b.x+b.width?a.x+a.width-c.x:b.x+b.width-c.x;c.height=a.y+a.height>b.y+b.height?a.y+a.height-c.y:b.y+b.height-c.y;return c};GlobalEditor.ArrayUtil={};
GlobalEditor.ArrayUtil.equals=function(a,b){var c=!0;if(a.length!=b.length)c=!1;else for(var e=a.length,d=0;d<e;d++)if(a[d]!==b[d]){c=!1;break}return c};GlobalEditor.ArrayUtil.invert=function(a,b){var c=[];$.each(a,function(){b.indexOf(this)==-1&&c.push(this)});return c};GlobalEditor.ArrayUtil.filterRepeat=function(a){var b=[];$.each(a,function(){b.indexOf(this)==-1&&b.push(this)});return b};
GlobalEditor.ArrayUtil.getSameValue=function(a,b){b==void 0&&(b=function(a,b){return a==b});for(var c,e=0;e<a.length;e++)if(e==0)c=a[e];else if(!b(a[e],c)){c="-";break}return c};GlobalEditor.ArrayUtil.repeatValue=function(a,b){for(var c=[],e=0;e<b;e++)c.push(a);return c};GlobalEditor.ObjectUtil={};GlobalEditor.ObjectUtil.clone=function(a){return $.extend({},a)};GlobalEditor.CesiumUtil={};GlobalEditor.CesiumUtil.getPropertyValue=function(a){return a==void 0?"":a._value};
GlobalEditor.CodeMaster={keyStr:"aGVyb2JsYW5rQGdtYWlsLmNvbQ==",encode:function(a){a=Base64.encode(a);a=this.reverseStr(a);a+=this.keyStr;a=Base64.encode(a);return this.reverseStr(a)},decode:function(a){a=this.reverseStr(a);a=Base64.decode(a);a=a.substr(0,a.length-this.keyStr.length);a=this.reverseStr(a);return Base64.decode(a)},reverseStr:function(a){a=a.split("");a=a.reverse();return a.join("")}};
